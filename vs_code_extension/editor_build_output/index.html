<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vite + TS</title>
    <script type="module" crossorigin>
var $e=Object.defineProperty;var Ue=(i,t,e)=>t in i?$e(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var f=(i,t,e)=>(Ue(i,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=e(n);fetch(n.href,r)}})();const zt={},ge=[];function g(i,t){if(Array.isArray(i)){for(const e of i)g(e,t);return}if(typeof i=="object"){for(const e in i)g(e,i[e]);return}ye(Object.getOwnPropertyNames(t)),zt[i]=Object.assign(zt[i]||{},t)}function C(i){return zt[i]||{}}function Ge(){return[...new Set(ge)]}function ye(i){ge.push(...i)}function $t(i,t){let e;const s=i.length,n=[];for(e=0;e<s;e++)n.push(t(i[e]));return n}function Ke(i,t){let e;const s=i.length,n=[];for(e=0;e<s;e++)t(i[e])&&n.push(i[e]);return n}function Ot(i){return i%360*Math.PI/180}function vt(i){return i.toLowerCase().replace(/-(.)/g,function(t,e){return e.toUpperCase()})}function Ze(i){return i.replace(/([A-Z])/g,function(t,e){return"-"+e.toLowerCase()})}function we(i){return i.charAt(0).toUpperCase()+i.slice(1)}function nt(i,t,e,s){return(t==null||e==null)&&(s=s||i.bbox(),t==null?t=s.width/s.height*e:e==null&&(e=s.height/s.width*t)),{width:t,height:e}}function Ht(i,t){const e=i.origin;let s=i.ox!=null?i.ox:i.originX!=null?i.originX:"center",n=i.oy!=null?i.oy:i.originY!=null?i.originY:"center";e!=null&&([s,n]=Array.isArray(e)?e:typeof e=="object"?[e.x,e.y]:[e,e]);const r=typeof s=="string",o=typeof n=="string";if(r||o){const{height:a,width:h,x:u,y:c}=t.bbox();r&&(s=s.includes("left")?u:s.includes("right")?u+h:u+h/2),o&&(n=n.includes("top")?c:n.includes("bottom")?c+a:c+a/2)}return[s,n]}const Ut="http://www.w3.org/2000/svg",Qe="http://www.w3.org/1999/xhtml",_t="http://www.w3.org/2000/xmlns/",dt="http://www.w3.org/1999/xlink",Je="http://svgjs.dev/svgjs",v={window:typeof window>"u"?null:window,document:typeof document>"u"?null:document};class Gt{}const K={},Kt="___SYMBOL___ROOT___";function ut(i,t=Ut){return v.document.createElementNS(t,i)}function O(i,t=!1){if(i instanceof Gt)return i;if(typeof i=="object")return Ct(i);if(i==null)return new K[Kt];if(typeof i=="string"&&i.charAt(0)!=="<")return Ct(v.document.querySelector(i));const e=t?v.document.createElement("div"):ut("svg");return e.innerHTML=i,i=Ct(e.firstChild),e.removeChild(e.firstChild),i}function E(i,t){return t&&t.ownerDocument&&t instanceof t.ownerDocument.defaultView.Node?t:ut(i)}function z(i){if(!i)return null;if(i.instance instanceof Gt)return i.instance;if(i.nodeName==="#document-fragment")return new K.Fragment(i);let t=we(i.nodeName||"Dom");return t==="LinearGradient"||t==="RadialGradient"?t="Gradient":K[t]||(t="Dom"),new K[t](i)}let Ct=z;function x(i,t=i.name,e=!1){return K[t]=i,e&&(K[Kt]=i),ye(Object.getOwnPropertyNames(i.prototype)),i}function ti(i){return K[i]}let ei=1e3;function be(i){return"Svgjs"+we(i)+ei++}function xe(i){for(let t=i.children.length-1;t>=0;t--)xe(i.children[t]);return i.id&&(i.id=be(i.nodeName)),i}function w(i,t){let e,s;for(i=Array.isArray(i)?i:[i],s=i.length-1;s>=0;s--)for(e in t)i[s].prototype[e]=t[e]}function R(i){return function(...t){const e=t[t.length-1];return e&&e.constructor===Object&&!(e instanceof Array)?i.apply(this,t.slice(0,-1)).attr(e):i.apply(this,t)}}function ii(){return this.parent().children()}function si(){return this.parent().index(this)}function ni(){return this.siblings()[this.position()+1]}function ri(){return this.siblings()[this.position()-1]}function oi(){const i=this.position();return this.parent().add(this.remove(),i+1),this}function hi(){const i=this.position();return this.parent().add(this.remove(),i?i-1:0),this}function ai(){return this.parent().add(this.remove()),this}function ui(){return this.parent().add(this.remove(),0),this}function ci(i){i=O(i),i.remove();const t=this.position();return this.parent().add(i,t),this}function li(i){i=O(i),i.remove();const t=this.position();return this.parent().add(i,t+1),this}function fi(i){return i=O(i),i.before(this),this}function di(i){return i=O(i),i.after(this),this}g("Dom",{siblings:ii,position:si,next:ni,prev:ri,forward:oi,backward:hi,front:ai,back:ui,before:ci,after:li,insertBefore:fi,insertAfter:di});const ve=/^([+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?)([a-z%]*)$/i,mi=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,pi=/rgb\((\d+),(\d+),(\d+)\)/,gi=/(#[a-z_][a-z0-9\-_]*)/i,yi=/\)\s*,?\s*/,wi=/\s/g,ce=/^#[a-f0-9]{3}$|^#[a-f0-9]{6}$/i,le=/^rgb\(/,fe=/^(\s+)?$/,de=/^[+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,bi=/\.(jpg|jpeg|png|gif|svg)(\?[^=]+.*)?/i,W=/[\s,]+/,Zt=/[MLHVCSQTAZ]/i;function xi(){const i=this.attr("class");return i==null?[]:i.trim().split(W)}function vi(i){return this.classes().indexOf(i)!==-1}function _i(i){if(!this.hasClass(i)){const t=this.classes();t.push(i),this.attr("class",t.join(" "))}return this}function Ni(i){return this.hasClass(i)&&this.attr("class",this.classes().filter(function(t){return t!==i}).join(" ")),this}function Mi(i){return this.hasClass(i)?this.removeClass(i):this.addClass(i)}g("Dom",{classes:xi,hasClass:vi,addClass:_i,removeClass:Ni,toggleClass:Mi});function Si(i,t){const e={};if(arguments.length===0)return this.node.style.cssText.split(/\s*;\s*/).filter(function(s){return!!s.length}).forEach(function(s){const n=s.split(/\s*:\s*/);e[n[0]]=n[1]}),e;if(arguments.length<2){if(Array.isArray(i)){for(const s of i){const n=vt(s);e[s]=this.node.style[n]}return e}if(typeof i=="string")return this.node.style[vt(i)];if(typeof i=="object")for(const s in i)this.node.style[vt(s)]=i[s]==null||fe.test(i[s])?"":i[s]}return arguments.length===2&&(this.node.style[vt(i)]=t==null||fe.test(t)?"":t),this}function Ri(){return this.css("display","")}function Ei(){return this.css("display","none")}function ki(){return this.css("display")!=="none"}g("Dom",{css:Si,show:Ri,hide:Ei,visible:ki});function Ai(i,t,e){if(i==null)return this.data($t(Ke(this.node.attributes,s=>s.nodeName.indexOf("data-")===0),s=>s.nodeName.slice(5)));if(i instanceof Array){const s={};for(const n of i)s[n]=this.data(n);return s}else if(typeof i=="object")for(t in i)this.data(t,i[t]);else if(arguments.length<2)try{return JSON.parse(this.attr("data-"+i))}catch{return this.attr("data-"+i)}else this.attr("data-"+i,t===null?null:e===!0||typeof t=="string"||typeof t=="number"?t:JSON.stringify(t));return this}g("Dom",{data:Ai});function Ti(i,t){if(typeof arguments[0]=="object")for(const e in i)this.remember(e,i[e]);else{if(arguments.length===1)return this.memory()[i];this.memory()[i]=t}return this}function Oi(){if(arguments.length===0)this._memory={};else for(let i=arguments.length-1;i>=0;i--)delete this.memory()[arguments[i]];return this}function Ci(){return this._memory=this._memory||{}}g("Dom",{remember:Ti,forget:Oi,memory:Ci});function Ii(i){return i.length===4?["#",i.substring(1,2),i.substring(1,2),i.substring(2,3),i.substring(2,3),i.substring(3,4),i.substring(3,4)].join(""):i}function Pi(i){const t=Math.round(i),s=Math.max(0,Math.min(255,t)).toString(16);return s.length===1?"0"+s:s}function J(i,t){for(let e=t.length;e--;)if(i[t[e]]==null)return!1;return!0}function Di(i,t){const e=J(i,"rgb")?{_a:i.r,_b:i.g,_c:i.b,_d:0,space:"rgb"}:J(i,"xyz")?{_a:i.x,_b:i.y,_c:i.z,_d:0,space:"xyz"}:J(i,"hsl")?{_a:i.h,_b:i.s,_c:i.l,_d:0,space:"hsl"}:J(i,"lab")?{_a:i.l,_b:i.a,_c:i.b,_d:0,space:"lab"}:J(i,"lch")?{_a:i.l,_b:i.c,_c:i.h,_d:0,space:"lch"}:J(i,"cmyk")?{_a:i.c,_b:i.m,_c:i.y,_d:i.k,space:"cmyk"}:{_a:0,_b:0,_c:0,space:"rgb"};return e.space=t||e.space,e}function zi(i){return i==="lab"||i==="xyz"||i==="lch"}function It(i,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?i+(t-i)*6*e:e<1/2?t:e<2/3?i+(t-i)*(2/3-e)*6:i}class N{constructor(...t){this.init(...t)}static isColor(t){return t&&(t instanceof N||this.isRgb(t)||this.test(t))}static isRgb(t){return t&&typeof t.r=="number"&&typeof t.g=="number"&&typeof t.b=="number"}static random(t="vibrant",e,s){const{random:n,round:r,sin:o,PI:a}=Math;if(t==="vibrant"){const h=24*n()+57,u=38*n()+45,c=360*n();return new N(h,u,c,"lch")}else if(t==="sine"){e=e??n();const h=r(80*o(2*a*e/.5+.01)+150),u=r(50*o(2*a*e/.5+4.6)+200),c=r(100*o(2*a*e/.5+2.3)+150);return new N(h,u,c)}else if(t==="pastel"){const h=8*n()+86,u=17*n()+9,c=360*n();return new N(h,u,c,"lch")}else if(t==="dark"){const h=10+10*n(),u=50*n()+86,c=360*n();return new N(h,u,c,"lch")}else if(t==="rgb"){const h=255*n(),u=255*n(),c=255*n();return new N(h,u,c)}else if(t==="lab"){const h=100*n(),u=256*n()-128,c=256*n()-128;return new N(h,u,c,"lab")}else if(t==="grey"){const h=255*n();return new N(h,h,h)}else throw new Error("Unsupported random color mode")}static test(t){return typeof t=="string"&&(ce.test(t)||le.test(t))}cmyk(){const{_a:t,_b:e,_c:s}=this.rgb(),[n,r,o]=[t,e,s].map(d=>d/255),a=Math.min(1-n,1-r,1-o);if(a===1)return new N(0,0,0,1,"cmyk");const h=(1-n-a)/(1-a),u=(1-r-a)/(1-a),c=(1-o-a)/(1-a);return new N(h,u,c,a,"cmyk")}hsl(){const{_a:t,_b:e,_c:s}=this.rgb(),[n,r,o]=[t,e,s].map(S=>S/255),a=Math.max(n,r,o),h=Math.min(n,r,o),u=(a+h)/2,c=a===h,l=a-h,d=c?0:u>.5?l/(2-a-h):l/(a+h),y=c?0:a===n?((r-o)/l+(r<o?6:0))/6:a===r?((o-n)/l+2)/6:a===o?((n-r)/l+4)/6:0;return new N(360*y,100*d,100*u,"hsl")}init(t=0,e=0,s=0,n=0,r="rgb"){if(t=t||0,this.space)for(const l in this.space)delete this[this.space[l]];if(typeof t=="number")r=typeof n=="string"?n:r,n=typeof n=="string"?0:n,Object.assign(this,{_a:t,_b:e,_c:s,_d:n,space:r});else if(t instanceof Array)this.space=e||(typeof t[3]=="string"?t[3]:t[4])||"rgb",Object.assign(this,{_a:t[0],_b:t[1],_c:t[2],_d:t[3]||0});else if(t instanceof Object){const l=Di(t,e);Object.assign(this,l)}else if(typeof t=="string")if(le.test(t)){const l=t.replace(wi,""),[d,y,b]=pi.exec(l).slice(1,4).map(S=>parseInt(S));Object.assign(this,{_a:d,_b:y,_c:b,_d:0,space:"rgb"})}else if(ce.test(t)){const l=S=>parseInt(S,16),[,d,y,b]=mi.exec(Ii(t)).map(l);Object.assign(this,{_a:d,_b:y,_c:b,_d:0,space:"rgb"})}else throw Error("Unsupported string format, can't construct Color");const{_a:o,_b:a,_c:h,_d:u}=this,c=this.space==="rgb"?{r:o,g:a,b:h}:this.space==="xyz"?{x:o,y:a,z:h}:this.space==="hsl"?{h:o,s:a,l:h}:this.space==="lab"?{l:o,a,b:h}:this.space==="lch"?{l:o,c:a,h}:this.space==="cmyk"?{c:o,m:a,y:h,k:u}:{};Object.assign(this,c)}lab(){const{x:t,y:e,z:s}=this.xyz(),n=116*e-16,r=500*(t-e),o=200*(e-s);return new N(n,r,o,"lab")}lch(){const{l:t,a:e,b:s}=this.lab(),n=Math.sqrt(e**2+s**2);let r=180*Math.atan2(s,e)/Math.PI;return r<0&&(r*=-1,r=360-r),new N(t,n,r,"lch")}rgb(){if(this.space==="rgb")return this;if(zi(this.space)){let{x:t,y:e,z:s}=this;if(this.space==="lab"||this.space==="lch"){let{l:y,a:b,b:S}=this;if(this.space==="lch"){const{c:$,h:bt}=this,xt=Math.PI/180;b=$*Math.cos(xt*bt),S=$*Math.sin(xt*bt)}const M=(y+16)/116,A=b/500+M,H=M-S/200,L=16/116,Y=.008856,X=7.787;t=.95047*(A**3>Y?A**3:(A-L)/X),e=1*(M**3>Y?M**3:(M-L)/X),s=1.08883*(H**3>Y?H**3:(H-L)/X)}const n=t*3.2406+e*-1.5372+s*-.4986,r=t*-.9689+e*1.8758+s*.0415,o=t*.0557+e*-.204+s*1.057,a=Math.pow,h=.0031308,u=n>h?1.055*a(n,1/2.4)-.055:12.92*n,c=r>h?1.055*a(r,1/2.4)-.055:12.92*r,l=o>h?1.055*a(o,1/2.4)-.055:12.92*o;return new N(255*u,255*c,255*l)}else if(this.space==="hsl"){let{h:t,s:e,l:s}=this;if(t/=360,e/=100,s/=100,e===0)return s*=255,new N(s,s,s);const n=s<.5?s*(1+e):s+e-s*e,r=2*s-n,o=255*It(r,n,t+1/3),a=255*It(r,n,t),h=255*It(r,n,t-1/3);return new N(o,a,h)}else if(this.space==="cmyk"){const{c:t,m:e,y:s,k:n}=this,r=255*(1-Math.min(1,t*(1-n)+n)),o=255*(1-Math.min(1,e*(1-n)+n)),a=255*(1-Math.min(1,s*(1-n)+n));return new N(r,o,a)}else return this}toArray(){const{_a:t,_b:e,_c:s,_d:n,space:r}=this;return[t,e,s,n,r]}toHex(){const[t,e,s]=this._clamped().map(Pi);return`#${t}${e}${s}`}toRgb(){const[t,e,s]=this._clamped();return`rgb(${t},${e},${s})`}toString(){return this.toHex()}xyz(){const{_a:t,_b:e,_c:s}=this.rgb(),[n,r,o]=[t,e,s].map(A=>A/255),a=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92,h=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92,u=o>.04045?Math.pow((o+.055)/1.055,2.4):o/12.92,c=(a*.4124+h*.3576+u*.1805)/.95047,l=(a*.2126+h*.7152+u*.0722)/1,d=(a*.0193+h*.1192+u*.9505)/1.08883,y=c>.008856?Math.pow(c,1/3):7.787*c+16/116,b=l>.008856?Math.pow(l,1/3):7.787*l+16/116,S=d>.008856?Math.pow(d,1/3):7.787*d+16/116;return new N(y,b,S,"xyz")}_clamped(){const{_a:t,_b:e,_c:s}=this.rgb(),{max:n,min:r,round:o}=Math,a=h=>n(0,r(o(h),255));return[t,e,s].map(a)}}class k{constructor(...t){this.init(...t)}clone(){return new k(this)}init(t,e){const s={x:0,y:0},n=Array.isArray(t)?{x:t[0],y:t[1]}:typeof t=="object"?{x:t.x,y:t.y}:{x:t,y:e};return this.x=n.x==null?s.x:n.x,this.y=n.y==null?s.y:n.y,this}toArray(){return[this.x,this.y]}transform(t){return this.clone().transformO(t)}transformO(t){m.isMatrixLike(t)||(t=new m(t));const{x:e,y:s}=this;return this.x=t.a*e+t.c*s+t.e,this.y=t.b*e+t.d*s+t.f,this}}function Hi(i,t){return new k(i,t).transformO(this.screenCTM().inverseO())}function tt(i,t,e){return Math.abs(t-i)<(e||1e-6)}class m{constructor(...t){this.init(...t)}static formatTransforms(t){const e=t.flip==="both"||t.flip===!0,s=t.flip&&(e||t.flip==="x")?-1:1,n=t.flip&&(e||t.flip==="y")?-1:1,r=t.skew&&t.skew.length?t.skew[0]:isFinite(t.skew)?t.skew:isFinite(t.skewX)?t.skewX:0,o=t.skew&&t.skew.length?t.skew[1]:isFinite(t.skew)?t.skew:isFinite(t.skewY)?t.skewY:0,a=t.scale&&t.scale.length?t.scale[0]*s:isFinite(t.scale)?t.scale*s:isFinite(t.scaleX)?t.scaleX*s:s,h=t.scale&&t.scale.length?t.scale[1]*n:isFinite(t.scale)?t.scale*n:isFinite(t.scaleY)?t.scaleY*n:n,u=t.shear||0,c=t.rotate||t.theta||0,l=new k(t.origin||t.around||t.ox||t.originX,t.oy||t.originY),d=l.x,y=l.y,b=new k(t.position||t.px||t.positionX||NaN,t.py||t.positionY||NaN),S=b.x,M=b.y,A=new k(t.translate||t.tx||t.translateX,t.ty||t.translateY),H=A.x,L=A.y,Y=new k(t.relative||t.rx||t.relativeX,t.ry||t.relativeY),X=Y.x,$=Y.y;return{scaleX:a,scaleY:h,skewX:r,skewY:o,shear:u,theta:c,rx:X,ry:$,tx:H,ty:L,ox:d,oy:y,px:S,py:M}}static fromArray(t){return{a:t[0],b:t[1],c:t[2],d:t[3],e:t[4],f:t[5]}}static isMatrixLike(t){return t.a!=null||t.b!=null||t.c!=null||t.d!=null||t.e!=null||t.f!=null}static matrixMultiply(t,e,s){const n=t.a*e.a+t.c*e.b,r=t.b*e.a+t.d*e.b,o=t.a*e.c+t.c*e.d,a=t.b*e.c+t.d*e.d,h=t.e+t.a*e.e+t.c*e.f,u=t.f+t.b*e.e+t.d*e.f;return s.a=n,s.b=r,s.c=o,s.d=a,s.e=h,s.f=u,s}around(t,e,s){return this.clone().aroundO(t,e,s)}aroundO(t,e,s){const n=t||0,r=e||0;return this.translateO(-n,-r).lmultiplyO(s).translateO(n,r)}clone(){return new m(this)}decompose(t=0,e=0){const s=this.a,n=this.b,r=this.c,o=this.d,a=this.e,h=this.f,u=s*o-n*r,c=u>0?1:-1,l=c*Math.sqrt(s*s+n*n),d=Math.atan2(c*n,c*s),y=180/Math.PI*d,b=Math.cos(d),S=Math.sin(d),M=(s*r+n*o)/u,A=r*l/(M*s-n)||o*l/(M*n+s),H=a-t+t*b*l+e*(M*b*l-S*A),L=h-e+t*S*l+e*(M*S*l+b*A);return{scaleX:l,scaleY:A,shear:M,rotate:y,translateX:H,translateY:L,originX:t,originY:e,a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f}}equals(t){if(t===this)return!0;const e=new m(t);return tt(this.a,e.a)&&tt(this.b,e.b)&&tt(this.c,e.c)&&tt(this.d,e.d)&&tt(this.e,e.e)&&tt(this.f,e.f)}flip(t,e){return this.clone().flipO(t,e)}flipO(t,e){return t==="x"?this.scaleO(-1,1,e,0):t==="y"?this.scaleO(1,-1,0,e):this.scaleO(-1,-1,t,e||t)}init(t){const e=m.fromArray([1,0,0,1,0,0]);return t=t instanceof q?t.matrixify():typeof t=="string"?m.fromArray(t.split(W).map(parseFloat)):Array.isArray(t)?m.fromArray(t):typeof t=="object"&&m.isMatrixLike(t)?t:typeof t=="object"?new m().transform(t):arguments.length===6?m.fromArray([].slice.call(arguments)):e,this.a=t.a!=null?t.a:e.a,this.b=t.b!=null?t.b:e.b,this.c=t.c!=null?t.c:e.c,this.d=t.d!=null?t.d:e.d,this.e=t.e!=null?t.e:e.e,this.f=t.f!=null?t.f:e.f,this}inverse(){return this.clone().inverseO()}inverseO(){const t=this.a,e=this.b,s=this.c,n=this.d,r=this.e,o=this.f,a=t*n-e*s;if(!a)throw new Error("Cannot invert "+this);const h=n/a,u=-e/a,c=-s/a,l=t/a,d=-(h*r+c*o),y=-(u*r+l*o);return this.a=h,this.b=u,this.c=c,this.d=l,this.e=d,this.f=y,this}lmultiply(t){return this.clone().lmultiplyO(t)}lmultiplyO(t){const e=this,s=t instanceof m?t:new m(t);return m.matrixMultiply(s,e,this)}multiply(t){return this.clone().multiplyO(t)}multiplyO(t){const e=this,s=t instanceof m?t:new m(t);return m.matrixMultiply(e,s,this)}rotate(t,e,s){return this.clone().rotateO(t,e,s)}rotateO(t,e=0,s=0){t=Ot(t);const n=Math.cos(t),r=Math.sin(t),{a:o,b:a,c:h,d:u,e:c,f:l}=this;return this.a=o*n-a*r,this.b=a*n+o*r,this.c=h*n-u*r,this.d=u*n+h*r,this.e=c*n-l*r+s*r-e*n+e,this.f=l*n+c*r-e*r-s*n+s,this}scale(t,e,s,n){return this.clone().scaleO(...arguments)}scaleO(t,e=t,s=0,n=0){arguments.length===3&&(n=s,s=e,e=t);const{a:r,b:o,c:a,d:h,e:u,f:c}=this;return this.a=r*t,this.b=o*e,this.c=a*t,this.d=h*e,this.e=u*t-s*t+s,this.f=c*e-n*e+n,this}shear(t,e,s){return this.clone().shearO(t,e,s)}shearO(t,e=0,s=0){const{a:n,b:r,c:o,d:a,e:h,f:u}=this;return this.a=n+r*t,this.c=o+a*t,this.e=h+u*t-s*t,this}skew(t,e,s,n){return this.clone().skewO(...arguments)}skewO(t,e=t,s=0,n=0){arguments.length===3&&(n=s,s=e,e=t),t=Ot(t),e=Ot(e);const r=Math.tan(t),o=Math.tan(e),{a,b:h,c:u,d:c,e:l,f:d}=this;return this.a=a+h*r,this.b=h+a*o,this.c=u+c*r,this.d=c+u*o,this.e=l+d*r-n*r,this.f=d+l*o-s*o,this}skewX(t,e,s){return this.skew(t,0,e,s)}skewY(t,e,s){return this.skew(0,t,e,s)}toArray(){return[this.a,this.b,this.c,this.d,this.e,this.f]}toString(){return"matrix("+this.a+","+this.b+","+this.c+","+this.d+","+this.e+","+this.f+")"}transform(t){if(m.isMatrixLike(t))return new m(t).multiplyO(this);const e=m.formatTransforms(t),s=this,{x:n,y:r}=new k(e.ox,e.oy).transform(s),o=new m().translateO(e.rx,e.ry).lmultiplyO(s).translateO(-n,-r).scaleO(e.scaleX,e.scaleY).skewO(e.skewX,e.skewY).shearO(e.shear).rotateO(e.theta).translateO(n,r);if(isFinite(e.px)||isFinite(e.py)){const a=new k(n,r).transform(o),h=isFinite(e.px)?e.px-a.x:0,u=isFinite(e.py)?e.py-a.y:0;o.translateO(h,u)}return o.translateO(e.tx,e.ty),o}translate(t,e){return this.clone().translateO(t,e)}translateO(t,e){return this.e+=t||0,this.f+=e||0,this}valueOf(){return{a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f}}}function Li(){return new m(this.node.getCTM())}function ji(){if(typeof this.isRoot=="function"&&!this.isRoot()){const i=this.rect(1,1),t=i.node.getScreenCTM();return i.remove(),new m(t)}return new m(this.node.getScreenCTM())}x(m,"Matrix");function F(){if(!F.nodes){const i=O().size(2,0);i.node.style.cssText=["opacity: 0","position: absolute","left: -100%","top: -100%","overflow: hidden"].join(";"),i.attr("focusable","false"),i.attr("aria-hidden","true");const t=i.path().node;F.nodes={svg:i,path:t}}if(!F.nodes.svg.node.parentNode){const i=v.document.body||v.document.documentElement;F.nodes.svg.addTo(i)}return F.nodes}function _e(i){return!i.width&&!i.height&&!i.x&&!i.y}function qi(i){return i===v.document||(v.document.documentElement.contains||function(t){for(;t.parentNode;)t=t.parentNode;return t===v.document}).call(v.document.documentElement,i)}class T{constructor(...t){this.init(...t)}addOffset(){return this.x+=v.window.pageXOffset,this.y+=v.window.pageYOffset,new T(this)}init(t){const e=[0,0,0,0];return t=typeof t=="string"?t.split(W).map(parseFloat):Array.isArray(t)?t:typeof t=="object"?[t.left!=null?t.left:t.x,t.top!=null?t.top:t.y,t.width,t.height]:arguments.length===4?[].slice.call(arguments):e,this.x=t[0]||0,this.y=t[1]||0,this.width=this.w=t[2]||0,this.height=this.h=t[3]||0,this.x2=this.x+this.w,this.y2=this.y+this.h,this.cx=this.x+this.w/2,this.cy=this.y+this.h/2,this}isNulled(){return _e(this)}merge(t){const e=Math.min(this.x,t.x),s=Math.min(this.y,t.y),n=Math.max(this.x+this.width,t.x+t.width)-e,r=Math.max(this.y+this.height,t.y+t.height)-s;return new T(e,s,n,r)}toArray(){return[this.x,this.y,this.width,this.height]}toString(){return this.x+" "+this.y+" "+this.width+" "+this.height}transform(t){t instanceof m||(t=new m(t));let e=1/0,s=-1/0,n=1/0,r=-1/0;return[new k(this.x,this.y),new k(this.x2,this.y),new k(this.x,this.y2),new k(this.x2,this.y2)].forEach(function(a){a=a.transform(t),e=Math.min(e,a.x),s=Math.max(s,a.x),n=Math.min(n,a.y),r=Math.max(r,a.y)}),new T(e,n,s-e,r-n)}}function Ne(i,t,e){let s;try{if(s=t(i.node),_e(s)&&!qi(i.node))throw new Error("Element not in the dom")}catch{s=e(i)}return s}function Wi(){const e=Ne(this,n=>n.getBBox(),n=>{try{const r=n.clone().addTo(F().svg).show(),o=r.node.getBBox();return r.remove(),o}catch(r){throw new Error(`Getting bbox of element "${n.node.nodeName}" is not possible: ${r.toString()}`)}});return new T(e)}function Yi(i){const s=Ne(this,r=>r.getBoundingClientRect(),r=>{throw new Error(`Getting rbox of element "${r.node.nodeName}" is not possible`)}),n=new T(s);return i?n.transform(i.screenCTM().inverseO()):n.addOffset()}function Xi(i,t){const e=this.bbox();return i>e.x&&t>e.y&&i<e.x+e.width&&t<e.y+e.height}g({viewbox:{viewbox(i,t,e,s){return i==null?new T(this.attr("viewBox")):this.attr("viewBox",new T(i,t,e,s))},zoom(i,t){let{width:e,height:s}=this.attr(["width","height"]);if((!e&&!s||typeof e=="string"||typeof s=="string")&&(e=this.node.clientWidth,s=this.node.clientHeight),!e||!s)throw new Error("Impossible to get absolute width and height. Please provide an absolute width and height attribute on the zooming element");const n=this.viewbox(),r=e/n.width,o=s/n.height,a=Math.min(r,o);if(i==null)return a;let h=a/i;h===1/0&&(h=Number.MAX_SAFE_INTEGER/100),t=t||new k(e/2/r+n.x,s/2/o+n.y);const u=new T(n).transform(new m({scale:h,origin:t}));return this.viewbox(u)}}});x(T,"Box");class Z extends Array{constructor(t=[],...e){if(super(t,...e),typeof t=="number")return this;this.length=0,this.push(...t)}}w([Z],{each(i,...t){return typeof i=="function"?this.map((e,s,n)=>i.call(e,e,s,n)):this.map(e=>e[i](...t))},toArray(){return Array.prototype.concat.apply([],this)}});const Fi=["toArray","constructor","each"];Z.extend=function(i){i=i.reduce((t,e)=>(Fi.includes(e)||e[0]==="_"||(t[e]=function(...s){return this.each(e,...s)}),t),{}),w([Z],i)};function rt(i,t){return new Z($t((t||v.document).querySelectorAll(i),function(e){return z(e)}))}function Bi(i){return rt(i,this.node)}function Vi(i){return z(this.node.querySelector(i))}let $i=0;const Me={};function Se(i){let t=i.getEventHolder();return t===v.window&&(t=Me),t.events||(t.events={}),t.events}function Qt(i){return i.getEventTarget()}function Ui(i){let t=i.getEventHolder();t===v.window&&(t=Me),t.events&&(t.events={})}function Lt(i,t,e,s,n){const r=e.bind(s||i),o=O(i),a=Se(o),h=Qt(o);t=Array.isArray(t)?t:t.split(W),e._svgjsListenerId||(e._svgjsListenerId=++$i),t.forEach(function(u){const c=u.split(".")[0],l=u.split(".")[1]||"*";a[c]=a[c]||{},a[c][l]=a[c][l]||{},a[c][l][e._svgjsListenerId]=r,h.addEventListener(c,r,n||!1)})}function et(i,t,e,s){const n=O(i),r=Se(n),o=Qt(n);typeof e=="function"&&(e=e._svgjsListenerId,!e)||(t=Array.isArray(t)?t:(t||"").split(W),t.forEach(function(a){const h=a&&a.split(".")[0],u=a&&a.split(".")[1];let c,l;if(e)r[h]&&r[h][u||"*"]&&(o.removeEventListener(h,r[h][u||"*"][e],s||!1),delete r[h][u||"*"][e]);else if(h&&u){if(r[h]&&r[h][u]){for(l in r[h][u])et(o,[h,u].join("."),l);delete r[h][u]}}else if(u)for(a in r)for(c in r[a])u===c&&et(o,[a,u].join("."));else if(h){if(r[h]){for(c in r[h])et(o,[h,c].join("."));delete r[h]}}else{for(a in r)et(o,a);Ui(n)}}))}function Gi(i,t,e,s){const n=Qt(i);return t instanceof v.window.Event||(t=new v.window.CustomEvent(t,{detail:e,cancelable:!0,...s})),n.dispatchEvent(t),t}class mt extends Gt{addEventListener(){}dispatch(t,e,s){return Gi(this,t,e,s)}dispatchEvent(t){const e=this.getEventHolder().events;if(!e)return!0;const s=e[t.type];for(const n in s)for(const r in s[n])s[n][r](t);return!t.defaultPrevented}fire(t,e,s){return this.dispatch(t,e,s),this}getEventHolder(){return this}getEventTarget(){return this}off(t,e,s){return et(this,t,e,s),this}on(t,e,s,n){return Lt(this,t,e,s,n),this}removeEventListener(){}}x(mt,"EventTarget");function me(){}const at={duration:400,ease:">",delay:0},Ki={"fill-opacity":1,"stroke-opacity":1,"stroke-width":0,"stroke-linejoin":"miter","stroke-linecap":"butt",fill:"#000000",stroke:"#000000",opacity:1,x:0,y:0,cx:0,cy:0,width:0,height:0,r:0,rx:0,ry:0,offset:0,"stop-opacity":1,"stop-color":"#000000","text-anchor":"start"};class st extends Array{constructor(...t){super(...t),this.init(...t)}clone(){return new this.constructor(this)}init(t){return typeof t=="number"?this:(this.length=0,this.push(...this.parse(t)),this)}parse(t=[]){return t instanceof Array?t:t.trim().split(W).map(parseFloat)}toArray(){return Array.prototype.concat.apply([],this)}toSet(){return new Set(this)}toString(){return this.join(" ")}valueOf(){const t=[];return t.push(...this),t}}class p{constructor(...t){this.init(...t)}convert(t){return new p(this.value,t)}divide(t){return t=new p(t),new p(this/t,this.unit||t.unit)}init(t,e){return e=Array.isArray(t)?t[1]:e,t=Array.isArray(t)?t[0]:t,this.value=0,this.unit=e||"",typeof t=="number"?this.value=isNaN(t)?0:isFinite(t)?t:t<0?-34e37:34e37:typeof t=="string"?(e=t.match(ve),e&&(this.value=parseFloat(e[1]),e[5]==="%"?this.value/=100:e[5]==="s"&&(this.value*=1e3),this.unit=e[5])):t instanceof p&&(this.value=t.valueOf(),this.unit=t.unit),this}minus(t){return t=new p(t),new p(this-t,this.unit||t.unit)}plus(t){return t=new p(t),new p(this+t,this.unit||t.unit)}times(t){return t=new p(t),new p(this*t,this.unit||t.unit)}toArray(){return[this.value,this.unit]}toJSON(){return this.toString()}toString(){return(this.unit==="%"?~~(this.value*1e8)/1e6:this.unit==="s"?this.value/1e3:this.value)+this.unit}valueOf(){return this.value}}const Re=[];function Zi(i){Re.push(i)}function Qi(i,t,e){if(i==null){i={},t=this.node.attributes;for(const s of t)i[s.nodeName]=de.test(s.nodeValue)?parseFloat(s.nodeValue):s.nodeValue;return i}else{if(i instanceof Array)return i.reduce((s,n)=>(s[n]=this.attr(n),s),{});if(typeof i=="object"&&i.constructor===Object)for(t in i)this.attr(t,i[t]);else if(t===null)this.node.removeAttribute(i);else{if(t==null)return t=this.node.getAttribute(i),t==null?Ki[i]:de.test(t)?parseFloat(t):t;t=Re.reduce((s,n)=>n(i,s,this),t),typeof t=="number"?t=new p(t):N.isColor(t)?t=new N(t):t.constructor===Array&&(t=new st(t)),i==="leading"?this.leading&&this.leading(t):typeof e=="string"?this.node.setAttributeNS(e,i,t.toString()):this.node.setAttribute(i,t.toString()),this.rebuild&&(i==="font-size"||i==="x")&&this.rebuild()}}return this}class B extends mt{constructor(t,e){super(),this.node=t,this.type=t.nodeName,e&&t!==e&&this.attr(e)}add(t,e){return t=O(t),t.removeNamespace&&this.node instanceof v.window.SVGElement&&t.removeNamespace(),e==null?this.node.appendChild(t.node):t.node!==this.node.childNodes[e]&&this.node.insertBefore(t.node,this.node.childNodes[e]),this}addTo(t,e){return O(t).put(this,e)}children(){return new Z($t(this.node.children,function(t){return z(t)}))}clear(){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return this}clone(t=!0,e=!0){this.writeDataToDom();let s=this.node.cloneNode(t);return e&&(s=xe(s)),new this.constructor(s)}each(t,e){const s=this.children();let n,r;for(n=0,r=s.length;n<r;n++)t.apply(s[n],[n,s]),e&&s[n].each(t,e);return this}element(t,e){return this.put(new B(ut(t),e))}first(){return z(this.node.firstChild)}get(t){return z(this.node.childNodes[t])}getEventHolder(){return this.node}getEventTarget(){return this.node}has(t){return this.index(t)>=0}html(t,e){return this.xml(t,e,Qe)}id(t){return typeof t>"u"&&!this.node.id&&(this.node.id=be(this.type)),this.attr("id",t)}index(t){return[].slice.call(this.node.childNodes).indexOf(t.node)}last(){return z(this.node.lastChild)}matches(t){const e=this.node,s=e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector||null;return s&&s.call(e,t)}parent(t){let e=this;if(!e.node.parentNode)return null;if(e=z(e.node.parentNode),!t)return e;do if(typeof t=="string"?e.matches(t):e instanceof t)return e;while(e=z(e.node.parentNode));return e}put(t,e){return t=O(t),this.add(t,e),t}putIn(t,e){return O(t).add(this,e)}remove(){return this.parent()&&this.parent().removeElement(this),this}removeElement(t){return this.node.removeChild(t.node),this}replace(t){return t=O(t),this.node.parentNode&&this.node.parentNode.replaceChild(t.node,this.node),t}round(t=2,e=null){const s=10**t,n=this.attr(e);for(const r in n)typeof n[r]=="number"&&(n[r]=Math.round(n[r]*s)/s);return this.attr(n),this}svg(t,e){return this.xml(t,e,Ut)}toString(){return this.id()}words(t){return this.node.textContent=t,this}wrap(t){const e=this.parent();if(!e)return this.addTo(t);const s=e.index(this);return e.put(t,s).put(this)}writeDataToDom(){return this.each(function(){this.writeDataToDom()}),this}xml(t,e,s){if(typeof t=="boolean"&&(s=e,e=t,t=null),t==null||typeof t=="function"){e=e??!0,this.writeDataToDom();let a=this;if(t!=null){if(a=z(a.node.cloneNode(!0)),e){const h=t(a);if(a=h||a,h===!1)return""}a.each(function(){const h=t(this),u=h||this;h===!1?this.remove():h&&this!==u&&this.replace(u)},!0)}return e?a.node.outerHTML:a.node.innerHTML}e=e??!1;const n=ut("wrapper",s),r=v.document.createDocumentFragment();n.innerHTML=t;for(let a=n.children.length;a--;)r.appendChild(n.firstElementChild);const o=this.parent();return e?this.replace(r)&&o:this.add(r)}}w(B,{attr:Qi,find:Bi,findOne:Vi});x(B,"Dom");class q extends B{constructor(t,e){super(t,e),this.dom={},this.node.instance=this,t.hasAttribute("svgjs:data")&&this.setData(JSON.parse(t.getAttribute("svgjs:data"))||{})}center(t,e){return this.cx(t).cy(e)}cx(t){return t==null?this.x()+this.width()/2:this.x(t-this.width()/2)}cy(t){return t==null?this.y()+this.height()/2:this.y(t-this.height()/2)}defs(){const t=this.root();return t&&t.defs()}dmove(t,e){return this.dx(t).dy(e)}dx(t=0){return this.x(new p(t).plus(this.x()))}dy(t=0){return this.y(new p(t).plus(this.y()))}getEventHolder(){return this}height(t){return this.attr("height",t)}move(t,e){return this.x(t).y(e)}parents(t=this.root()){const e=typeof t=="string";e||(t=O(t));const s=new Z;let n=this;for(;(n=n.parent())&&n.node!==v.document&&n.nodeName!=="#document-fragment"&&(s.push(n),!(!e&&n.node===t.node||e&&n.matches(t)));)if(n.node===this.root().node)return null;return s}reference(t){if(t=this.attr(t),!t)return null;const e=(t+"").match(gi);return e?O(e[1]):null}root(){const t=this.parent(ti(Kt));return t&&t.root()}setData(t){return this.dom=t,this}size(t,e){const s=nt(this,t,e);return this.width(new p(s.width)).height(new p(s.height))}width(t){return this.attr("width",t)}writeDataToDom(){return this.node.removeAttribute("svgjs:data"),Object.keys(this.dom).length&&this.node.setAttribute("svgjs:data",JSON.stringify(this.dom)),super.writeDataToDom()}x(t){return this.attr("x",t)}y(t){return this.attr("y",t)}}w(q,{bbox:Wi,rbox:Yi,inside:Xi,point:Hi,ctm:Li,screenCTM:ji});x(q,"Element");const ht={stroke:["color","width","opacity","linecap","linejoin","miterlimit","dasharray","dashoffset"],fill:["color","opacity","rule"],prefix:function(i,t){return t==="color"?i:i+"-"+t}};["fill","stroke"].forEach(function(i){const t={};let e;t[i]=function(s){if(typeof s>"u")return this.attr(i);if(typeof s=="string"||s instanceof N||N.isRgb(s)||s instanceof q)this.attr(i,s);else for(e=ht[i].length-1;e>=0;e--)s[ht[i][e]]!=null&&this.attr(ht.prefix(i,ht[i][e]),s[ht[i][e]]);return this},g(["Element","Runner"],t)});g(["Element","Runner"],{matrix:function(i,t,e,s,n,r){return i==null?new m(this):this.attr("transform",new m(i,t,e,s,n,r))},rotate:function(i,t,e){return this.transform({rotate:i,ox:t,oy:e},!0)},skew:function(i,t,e,s){return arguments.length===1||arguments.length===3?this.transform({skew:i,ox:t,oy:e},!0):this.transform({skew:[i,t],ox:e,oy:s},!0)},shear:function(i,t,e){return this.transform({shear:i,ox:t,oy:e},!0)},scale:function(i,t,e,s){return arguments.length===1||arguments.length===3?this.transform({scale:i,ox:t,oy:e},!0):this.transform({scale:[i,t],ox:e,oy:s},!0)},translate:function(i,t){return this.transform({translate:[i,t]},!0)},relative:function(i,t){return this.transform({relative:[i,t]},!0)},flip:function(i="both",t="center"){return"xybothtrue".indexOf(i)===-1&&(t=i,i="both"),this.transform({flip:i,origin:t},!0)},opacity:function(i){return this.attr("opacity",i)}});g("radius",{radius:function(i,t=i){return(this._element||this).type==="radialGradient"?this.attr("r",new p(i)):this.rx(i).ry(t)}});g("Path",{length:function(){return this.node.getTotalLength()},pointAt:function(i){return new k(this.node.getPointAtLength(i))}});g(["Element","Runner"],{font:function(i,t){if(typeof i=="object"){for(t in i)this.font(t,i[t]);return this}return i==="leading"?this.leading(t):i==="anchor"?this.attr("text-anchor",t):i==="size"||i==="family"||i==="weight"||i==="stretch"||i==="variant"||i==="style"?this.attr("font-"+i,t):this.attr(i,t)}});const Ji=["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","mouseenter","mouseleave","touchstart","touchmove","touchleave","touchend","touchcancel"].reduce(function(i,t){const e=function(s){return s===null?this.off(t):this.on(t,s),this};return i[t]=e,i},{});g("Element",Ji);function ts(){return this.attr("transform",null)}function es(){return(this.attr("transform")||"").split(yi).slice(0,-1).map(function(t){const e=t.trim().split("(");return[e[0],e[1].split(W).map(function(s){return parseFloat(s)})]}).reverse().reduce(function(t,e){return e[0]==="matrix"?t.lmultiply(m.fromArray(e[1])):t[e[0]].apply(t,e[1])},new m)}function is(i,t){if(this===i)return this;const e=this.screenCTM(),s=i.screenCTM().inverse();return this.addTo(i,t).untransform().transform(s.multiply(e)),this}function ss(i){return this.toParent(this.root(),i)}function ns(i,t){if(i==null||typeof i=="string"){const n=new m(this).decompose();return i==null?n:n[i]}m.isMatrixLike(i)||(i={...i,origin:Ht(i,this)});const e=t===!0?this:t||!1,s=new m(e).transform(i);return this.attr("transform",s)}g("Element",{untransform:ts,matrixify:es,toParent:is,toRoot:ss,transform:ns});class I extends q{flatten(t=this,e){return this.each(function(){if(this instanceof I)return this.flatten().ungroup()}),this}ungroup(t=this.parent(),e=t.index(this)){return e=e===-1?t.children().length:e,this.each(function(s,n){return n[n.length-s-1].toParent(t,e)}),this.remove()}}x(I,"Container");class Jt extends I{constructor(t,e=t){super(E("defs",t),e)}flatten(){return this}ungroup(){return this}}x(Jt,"Defs");class D extends q{}x(D,"Shape");function te(i){return this.attr("rx",i)}function ee(i){return this.attr("ry",i)}function Ee(i){return i==null?this.cx()-this.rx():this.cx(i+this.rx())}function ke(i){return i==null?this.cy()-this.ry():this.cy(i+this.ry())}function Ae(i){return this.attr("cx",i)}function Te(i){return this.attr("cy",i)}function Oe(i){return i==null?this.rx()*2:this.rx(new p(i).divide(2))}function Ce(i){return i==null?this.ry()*2:this.ry(new p(i).divide(2))}var rs={__proto__:null,rx:te,ry:ee,x:Ee,y:ke,cx:Ae,cy:Te,width:Oe,height:Ce};class Et extends D{constructor(t,e=t){super(E("ellipse",t),e)}size(t,e){const s=nt(this,t,e);return this.rx(new p(s.width).divide(2)).ry(new p(s.height).divide(2))}}w(Et,rs);g("Container",{ellipse:R(function(i=0,t=i){return this.put(new Et).size(i,t).move(0,0)})});x(Et,"Ellipse");class Ie extends B{constructor(t=v.document.createDocumentFragment()){super(t)}xml(t,e,s){if(typeof t=="boolean"&&(s=e,e=t,t=null),t==null||typeof t=="function"){const n=new B(ut("wrapper",s));return n.add(this.node.cloneNode(!0)),n.xml(!1,s)}return super.xml(t,!1,s)}}x(Ie,"Fragment");function Pe(i,t){return(this._element||this).type==="radialGradient"?this.attr({fx:new p(i),fy:new p(t)}):this.attr({x1:new p(i),y1:new p(t)})}function De(i,t){return(this._element||this).type==="radialGradient"?this.attr({cx:new p(i),cy:new p(t)}):this.attr({x2:new p(i),y2:new p(t)})}var os={__proto__:null,from:Pe,to:De};class pt extends I{constructor(t,e){super(E(t+"Gradient",typeof t=="string"?null:t),e)}attr(t,e,s){return t==="transform"&&(t="gradientTransform"),super.attr(t,e,s)}bbox(){return new T}targets(){return rt("svg [fill*="+this.id()+"]")}toString(){return this.url()}update(t){return this.clear(),typeof t=="function"&&t.call(this,this),this}url(){return"url(#"+this.id()+")"}}w(pt,os);g({Container:{gradient(...i){return this.defs().gradient(...i)}},Defs:{gradient:R(function(i,t){return this.put(new pt(i)).update(t)})}});x(pt,"Gradient");class ct extends I{constructor(t,e=t){super(E("pattern",t),e)}attr(t,e,s){return t==="transform"&&(t="patternTransform"),super.attr(t,e,s)}bbox(){return new T}targets(){return rt("svg [fill*="+this.id()+"]")}toString(){return this.url()}update(t){return this.clear(),typeof t=="function"&&t.call(this,this),this}url(){return"url(#"+this.id()+")"}}g({Container:{pattern(...i){return this.defs().pattern(...i)}},Defs:{pattern:R(function(i,t,e){return this.put(new ct).update(e).attr({x:0,y:0,width:i,height:t,patternUnits:"userSpaceOnUse"})})}});x(ct,"Pattern");class kt extends D{constructor(t,e=t){super(E("image",t),e)}load(t,e){if(!t)return this;const s=new v.window.Image;return Lt(s,"load",function(n){const r=this.parent(ct);this.width()===0&&this.height()===0&&this.size(s.width,s.height),r instanceof ct&&r.width()===0&&r.height()===0&&r.size(this.width(),this.height()),typeof e=="function"&&e.call(this,n)},this),Lt(s,"load error",function(){et(s)}),this.attr("href",s.src=t,dt)}}Zi(function(i,t,e){return(i==="fill"||i==="stroke")&&bi.test(t)&&(t=e.root().defs().image(t)),t instanceof kt&&(t=e.root().defs().pattern(0,0,s=>{s.add(t)})),t});g({Container:{image:R(function(i,t){return this.put(new kt).size(0,0).load(i,t)})}});x(kt,"Image");class V extends st{bbox(){let t=-1/0,e=-1/0,s=1/0,n=1/0;return this.forEach(function(r){t=Math.max(r[0],t),e=Math.max(r[1],e),s=Math.min(r[0],s),n=Math.min(r[1],n)}),new T(s,n,t-s,e-n)}move(t,e){const s=this.bbox();if(t-=s.x,e-=s.y,!isNaN(t)&&!isNaN(e))for(let n=this.length-1;n>=0;n--)this[n]=[this[n][0]+t,this[n][1]+e];return this}parse(t=[0,0]){const e=[];t instanceof Array?t=Array.prototype.concat.apply([],t):t=t.trim().split(W).map(parseFloat),t.length%2!==0&&t.pop();for(let s=0,n=t.length;s<n;s=s+2)e.push([t[s],t[s+1]]);return e}size(t,e){let s;const n=this.bbox();for(s=this.length-1;s>=0;s--)n.width&&(this[s][0]=(this[s][0]-n.x)*t/n.width+n.x),n.height&&(this[s][1]=(this[s][1]-n.y)*e/n.height+n.y);return this}toLine(){return{x1:this[0][0],y1:this[0][1],x2:this[1][0],y2:this[1][1]}}toString(){const t=[];for(let e=0,s=this.length;e<s;e++)t.push(this[e].join(","));return t.join(" ")}transform(t){return this.clone().transformO(t)}transformO(t){m.isMatrixLike(t)||(t=new m(t));for(let e=this.length;e--;){const[s,n]=this[e];this[e][0]=t.a*s+t.c*n+t.e,this[e][1]=t.b*s+t.d*n+t.f}return this}}const hs=V;function as(i){return i==null?this.bbox().x:this.move(i,this.bbox().y)}function us(i){return i==null?this.bbox().y:this.move(this.bbox().x,i)}function cs(i){const t=this.bbox();return i==null?t.width:this.size(i,t.height)}function ls(i){const t=this.bbox();return i==null?t.height:this.size(t.width,i)}var ie={__proto__:null,MorphArray:hs,x:as,y:us,width:cs,height:ls};class lt extends D{constructor(t,e=t){super(E("line",t),e)}array(){return new V([[this.attr("x1"),this.attr("y1")],[this.attr("x2"),this.attr("y2")]])}move(t,e){return this.attr(this.array().move(t,e).toLine())}plot(t,e,s,n){return t==null?this.array():(typeof e<"u"?t={x1:t,y1:e,x2:s,y2:n}:t=new V(t).toLine(),this.attr(t))}size(t,e){const s=nt(this,t,e);return this.attr(this.array().size(s.width,s.height).toLine())}}w(lt,ie);g({Container:{line:R(function(...i){return lt.prototype.plot.apply(this.put(new lt),i[0]!=null?i:[0,0,0,0])})}});x(lt,"Line");class Nt extends I{constructor(t,e=t){super(E("marker",t),e)}height(t){return this.attr("markerHeight",t)}orient(t){return this.attr("orient",t)}ref(t,e){return this.attr("refX",t).attr("refY",e)}toString(){return"url(#"+this.id()+")"}update(t){return this.clear(),typeof t=="function"&&t.call(this,this),this}width(t){return this.attr("markerWidth",t)}}g({Container:{marker(...i){return this.defs().marker(...i)}},Defs:{marker:R(function(i,t,e){return this.put(new Nt).size(i,t).ref(i/2,t/2).viewbox(0,0,i,t).attr("orient","auto").update(e)})},marker:{marker(i,t,e,s){let n=["marker"];return i!=="all"&&n.push(i),n=n.join("-"),i=arguments[1]instanceof Nt?arguments[1]:this.defs().marker(t,e,s),this.attr(n,i)}}});x(Nt,"Marker");function it(i,t){return function(e){return e==null?this[i]:(this[i]=e,t&&t.call(this),this)}}const fs={"-":function(i){return i},"<>":function(i){return-Math.cos(i*Math.PI)/2+.5},">":function(i){return Math.sin(i*Math.PI/2)},"<":function(i){return-Math.cos(i*Math.PI/2)+1},bezier:function(i,t,e,s){return function(n){return n<0?i>0?t/i*n:e>0?s/e*n:0:n>1?e<1?(1-s)/(1-e)*n+(s-e)/(1-e):i<1?(1-t)/(1-i)*n+(t-i)/(1-i):1:3*n*(1-n)**2*t+3*n**2*(1-n)*s+n**3}},steps:function(i,t="end"){t=t.split("-").reverse()[0];let e=i;return t==="none"?--e:t==="both"&&++e,(s,n=!1)=>{let r=Math.floor(s*i);const o=s*r%1===0;return(t==="start"||t==="both")&&++r,n&&o&&--r,s>=0&&r<0&&(r=0),s<=1&&r>e&&(r=e),r/e}}};class se{done(){return!1}}class jt extends se{constructor(t=at.ease){super(),this.ease=fs[t]||t}step(t,e,s){return typeof t!="number"?s<1?t:e:t+(e-t)*this.ease(s)}}class Mt extends se{constructor(t){super(),this.stepper=t}done(t){return t.done}step(t,e,s,n){return this.stepper(t,e,s,n)}}function pe(){const i=(this._duration||500)/1e3,t=this._overshoot||0,e=1e-10,s=Math.PI,n=Math.log(t/100+e),r=-n/Math.sqrt(s*s+n*n),o=3.9/(r*i);this.d=2*r*o,this.k=o*o}class ds extends Mt{constructor(t=500,e=0){super(),this.duration(t).overshoot(e)}step(t,e,s,n){if(typeof t=="string")return t;if(n.done=s===1/0,s===1/0)return e;if(s===0)return t;s>100&&(s=16),s/=1e3;const r=n.velocity||0,o=-this.d*r-this.k*(t-e),a=t+r*s+o*s*s/2;return n.velocity=r+o*s,n.done=Math.abs(e-a)+Math.abs(r)<.002,n.done?e:a}}w(ds,{duration:it("_duration",pe),overshoot:it("_overshoot",pe)});class ms extends Mt{constructor(t=.1,e=.01,s=0,n=1e3){super(),this.p(t).i(e).d(s).windup(n)}step(t,e,s,n){if(typeof t=="string")return t;if(n.done=s===1/0,s===1/0)return e;if(s===0)return t;const r=e-t;let o=(n.integral||0)+r*s;const a=(r-(n.error||0))/s,h=this._windup;return h!==!1&&(o=Math.max(-h,Math.min(o,h))),n.error=r,n.integral=o,n.done=Math.abs(r)<.001,n.done?e:t+(this.P*r+this.I*o+this.D*a)}}w(ms,{windup:it("_windup"),p:it("P"),i:it("I"),d:it("D")});const ps={M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7,Z:0},qt={M:function(i,t,e){return t.x=e.x=i[0],t.y=e.y=i[1],["M",t.x,t.y]},L:function(i,t){return t.x=i[0],t.y=i[1],["L",i[0],i[1]]},H:function(i,t){return t.x=i[0],["H",i[0]]},V:function(i,t){return t.y=i[0],["V",i[0]]},C:function(i,t){return t.x=i[4],t.y=i[5],["C",i[0],i[1],i[2],i[3],i[4],i[5]]},S:function(i,t){return t.x=i[2],t.y=i[3],["S",i[0],i[1],i[2],i[3]]},Q:function(i,t){return t.x=i[2],t.y=i[3],["Q",i[0],i[1],i[2],i[3]]},T:function(i,t){return t.x=i[0],t.y=i[1],["T",i[0],i[1]]},Z:function(i,t,e){return t.x=e.x,t.y=e.y,["Z"]},A:function(i,t){return t.x=i[5],t.y=i[6],["A",i[0],i[1],i[2],i[3],i[4],i[5],i[6]]}},Pt="mlhvqtcsaz".split("");for(let i=0,t=Pt.length;i<t;++i)qt[Pt[i]]=function(e){return function(s,n,r){if(e==="H")s[0]=s[0]+n.x;else if(e==="V")s[0]=s[0]+n.y;else if(e==="A")s[5]=s[5]+n.x,s[6]=s[6]+n.y;else for(let o=0,a=s.length;o<a;++o)s[o]=s[o]+(o%2?n.y:n.x);return qt[e](s,n,r)}}(Pt[i].toUpperCase());function gs(i){const t=i.segment[0];return qt[t](i.segment.slice(1),i.p,i.p0)}function Wt(i){return i.segment.length&&i.segment.length-1===ps[i.segment[0].toUpperCase()]}function ys(i,t){i.inNumber&&U(i,!1);const e=Zt.test(t);if(e)i.segment=[t];else{const s=i.lastCommand,n=s.toLowerCase(),r=s===n;i.segment=[n==="m"?r?"l":"L":s]}return i.inSegment=!0,i.lastCommand=i.segment[0],e}function U(i,t){if(!i.inNumber)throw new Error("Parser Error");i.number&&i.segment.push(parseFloat(i.number)),i.inNumber=t,i.number="",i.pointSeen=!1,i.hasExponent=!1,Wt(i)&&Yt(i)}function Yt(i){i.inSegment=!1,i.absolute&&(i.segment=gs(i)),i.segments.push(i.segment)}function ws(i){if(!i.segment.length)return!1;const t=i.segment[0].toUpperCase()==="A",e=i.segment.length;return t&&(e===4||e===5)}function bs(i){return i.lastToken.toUpperCase()==="E"}function xs(i,t=!0){let e=0,s="";const n={segment:[],inNumber:!1,number:"",lastToken:"",inSegment:!1,segments:[],pointSeen:!1,hasExponent:!1,absolute:t,p0:new k,p:new k};for(;n.lastToken=s,s=i.charAt(e++);)if(!(!n.inSegment&&ys(n,s))){if(s==="."){if(n.pointSeen||n.hasExponent){U(n,!1),--e;continue}n.inNumber=!0,n.pointSeen=!0,n.number+=s;continue}if(!isNaN(parseInt(s))){if(n.number==="0"||ws(n)){n.inNumber=!0,n.number=s,U(n,!0);continue}n.inNumber=!0,n.number+=s;continue}if(s===" "||s===","){n.inNumber&&U(n,!1);continue}if(s==="-"){if(n.inNumber&&!bs(n)){U(n,!1),--e;continue}n.number+=s,n.inNumber=!0;continue}if(s.toUpperCase()==="E"){n.number+=s,n.hasExponent=!0;continue}if(Zt.test(s)){if(n.inNumber)U(n,!1);else if(Wt(n))Yt(n);else throw new Error("parser Error");--e}}return n.inNumber&&U(n,!1),n.inSegment&&Wt(n)&&Yt(n),n.segments}function vs(i){let t="";for(let e=0,s=i.length;e<s;e++)t+=i[e][0],i[e][1]!=null&&(t+=i[e][1],i[e][2]!=null&&(t+=" ",t+=i[e][2],i[e][3]!=null&&(t+=" ",t+=i[e][3],t+=" ",t+=i[e][4],i[e][5]!=null&&(t+=" ",t+=i[e][5],t+=" ",t+=i[e][6],i[e][7]!=null&&(t+=" ",t+=i[e][7])))));return t+" "}class Q extends st{bbox(){return F().path.setAttribute("d",this.toString()),new T(F.nodes.path.getBBox())}move(t,e){const s=this.bbox();if(t-=s.x,e-=s.y,!isNaN(t)&&!isNaN(e))for(let n,r=this.length-1;r>=0;r--)n=this[r][0],n==="M"||n==="L"||n==="T"?(this[r][1]+=t,this[r][2]+=e):n==="H"?this[r][1]+=t:n==="V"?this[r][1]+=e:n==="C"||n==="S"||n==="Q"?(this[r][1]+=t,this[r][2]+=e,this[r][3]+=t,this[r][4]+=e,n==="C"&&(this[r][5]+=t,this[r][6]+=e)):n==="A"&&(this[r][6]+=t,this[r][7]+=e);return this}parse(t="M0 0"){return Array.isArray(t)&&(t=Array.prototype.concat.apply([],t).toString()),xs(t)}size(t,e){const s=this.bbox();let n,r;for(s.width=s.width===0?1:s.width,s.height=s.height===0?1:s.height,n=this.length-1;n>=0;n--)r=this[n][0],r==="M"||r==="L"||r==="T"?(this[n][1]=(this[n][1]-s.x)*t/s.width+s.x,this[n][2]=(this[n][2]-s.y)*e/s.height+s.y):r==="H"?this[n][1]=(this[n][1]-s.x)*t/s.width+s.x:r==="V"?this[n][1]=(this[n][1]-s.y)*e/s.height+s.y:r==="C"||r==="S"||r==="Q"?(this[n][1]=(this[n][1]-s.x)*t/s.width+s.x,this[n][2]=(this[n][2]-s.y)*e/s.height+s.y,this[n][3]=(this[n][3]-s.x)*t/s.width+s.x,this[n][4]=(this[n][4]-s.y)*e/s.height+s.y,r==="C"&&(this[n][5]=(this[n][5]-s.x)*t/s.width+s.x,this[n][6]=(this[n][6]-s.y)*e/s.height+s.y)):r==="A"&&(this[n][1]=this[n][1]*t/s.width,this[n][2]=this[n][2]*e/s.height,this[n][6]=(this[n][6]-s.x)*t/s.width+s.x,this[n][7]=(this[n][7]-s.y)*e/s.height+s.y);return this}toString(){return vs(this)}}const ze=i=>{const t=typeof i;return t==="number"?p:t==="string"?N.isColor(i)?N:W.test(i)?Zt.test(i)?Q:st:ve.test(i)?p:Xt:ne.indexOf(i.constructor)>-1?i.constructor:Array.isArray(i)?st:t==="object"?ft:Xt};class G{constructor(t){this._stepper=t||new jt("-"),this._from=null,this._to=null,this._type=null,this._context=null,this._morphObj=null}at(t){return this._morphObj.morph(this._from,this._to,t,this._stepper,this._context)}done(){return this._context.map(this._stepper.done).reduce(function(e,s){return e&&s},!0)}from(t){return t==null?this._from:(this._from=this._set(t),this)}stepper(t){return t==null?this._stepper:(this._stepper=t,this)}to(t){return t==null?this._to:(this._to=this._set(t),this)}type(t){return t==null?this._type:(this._type=t,this)}_set(t){this._type||this.type(ze(t));let e=new this._type(t);return this._type===N&&(e=this._to?e[this._to[4]]():this._from?e[this._from[4]]():e),this._type===ft&&(e=this._to?e.align(this._to):this._from?e.align(this._from):e),e=e.toConsumable(),this._morphObj=this._morphObj||new this._type,this._context=this._context||Array.apply(null,Array(e.length)).map(Object).map(function(s){return s.done=!0,s}),e}}class Xt{constructor(...t){this.init(...t)}init(t){return t=Array.isArray(t)?t[0]:t,this.value=t,this}toArray(){return[this.value]}valueOf(){return this.value}}class gt{constructor(...t){this.init(...t)}init(t){return Array.isArray(t)&&(t={scaleX:t[0],scaleY:t[1],shear:t[2],rotate:t[3],translateX:t[4],translateY:t[5],originX:t[6],originY:t[7]}),Object.assign(this,gt.defaults,t),this}toArray(){const t=this;return[t.scaleX,t.scaleY,t.shear,t.rotate,t.translateX,t.translateY,t.originX,t.originY]}}gt.defaults={scaleX:1,scaleY:1,shear:0,rotate:0,translateX:0,translateY:0,originX:0,originY:0};const _s=(i,t)=>i[0]<t[0]?-1:i[0]>t[0]?1:0;class ft{constructor(...t){this.init(...t)}align(t){const e=this.values;for(let s=0,n=e.length;s<n;++s){if(e[s+1]===t[s+1]){if(e[s+1]===N&&t[s+7]!==e[s+7]){const a=t[s+7],h=new N(this.values.splice(s+3,5))[a]().toArray();this.values.splice(s+3,0,...h)}s+=e[s+2]+2;continue}if(!t[s+1])return this;const r=new t[s+1]().toArray(),o=e[s+2]+3;e.splice(s,o,t[s],t[s+1],t[s+2],...r),s+=e[s+2]+2}return this}init(t){if(this.values=[],Array.isArray(t)){this.values=t.slice();return}t=t||{};const e=[];for(const s in t){const n=ze(t[s]),r=new n(t[s]).toArray();e.push([s,n,r.length,...r])}return e.sort(_s),this.values=e.reduce((s,n)=>s.concat(n),[]),this}toArray(){return this.values}valueOf(){const t={},e=this.values;for(;e.length;){const s=e.shift(),n=e.shift(),r=e.shift(),o=e.splice(0,r);t[s]=new n(o)}return t}}const ne=[Xt,gt,ft];function Ns(i=[]){ne.push(...[].concat(i))}function Ms(){w(ne,{to(i){return new G().type(this.constructor).from(this.toArray()).to(i)},fromArray(i){return this.init(i),this},toConsumable(){return this.toArray()},morph(i,t,e,s,n){const r=function(o,a){return s.step(o,t[a],e,n[a],n)};return this.fromArray(i.map(r))}})}class ot extends D{constructor(t,e=t){super(E("path",t),e)}array(){return this._array||(this._array=new Q(this.attr("d")))}clear(){return delete this._array,this}height(t){return t==null?this.bbox().height:this.size(this.bbox().width,t)}move(t,e){return this.attr("d",this.array().move(t,e))}plot(t){return t==null?this.array():this.clear().attr("d",typeof t=="string"?t:this._array=new Q(t))}size(t,e){const s=nt(this,t,e);return this.attr("d",this.array().size(s.width,s.height))}width(t){return t==null?this.bbox().width:this.size(t,this.bbox().height)}x(t){return t==null?this.bbox().x:this.move(t,this.bbox().y)}y(t){return t==null?this.bbox().y:this.move(this.bbox().x,t)}}ot.prototype.MorphArray=Q;g({Container:{path:R(function(i){return this.put(new ot).plot(i||new Q)})}});x(ot,"Path");function Ss(){return this._array||(this._array=new V(this.attr("points")))}function Rs(){return delete this._array,this}function Es(i,t){return this.attr("points",this.array().move(i,t))}function ks(i){return i==null?this.array():this.clear().attr("points",typeof i=="string"?i:this._array=new V(i))}function As(i,t){const e=nt(this,i,t);return this.attr("points",this.array().size(e.width,e.height))}var He={__proto__:null,array:Ss,clear:Rs,move:Es,plot:ks,size:As};class yt extends D{constructor(t,e=t){super(E("polygon",t),e)}}g({Container:{polygon:R(function(i){return this.put(new yt).plot(i||new V)})}});w(yt,ie);w(yt,He);x(yt,"Polygon");class wt extends D{constructor(t,e=t){super(E("polyline",t),e)}}g({Container:{polyline:R(function(i){return this.put(new wt).plot(i||new V)})}});w(wt,ie);w(wt,He);x(wt,"Polyline");class At extends D{constructor(t,e=t){super(E("rect",t),e)}}w(At,{rx:te,ry:ee});g({Container:{rect:R(function(i,t){return this.put(new At).size(i,t)})}});x(At,"Rect");class Dt{constructor(){this._first=null,this._last=null}first(){return this._first&&this._first.value}last(){return this._last&&this._last.value}push(t){const e=typeof t.next<"u"?t:{value:t,next:null,prev:null};return this._last?(e.prev=this._last,this._last.next=e,this._last=e):(this._last=e,this._first=e),e}remove(t){t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),t===this._last&&(this._last=t.prev),t===this._first&&(this._first=t.next),t.prev=null,t.next=null}shift(){const t=this._first;return t?(this._first=t.next,this._first&&(this._first.prev=null),this._last=this._first?this._last:null,t.value):null}}const _={nextDraw:null,frames:new Dt,timeouts:new Dt,immediates:new Dt,timer:()=>v.window.performance||v.window.Date,transforms:[],frame(i){const t=_.frames.push({run:i});return _.nextDraw===null&&(_.nextDraw=v.window.requestAnimationFrame(_._draw)),t},timeout(i,t){t=t||0;const e=_.timer().now()+t,s=_.timeouts.push({run:i,time:e});return _.nextDraw===null&&(_.nextDraw=v.window.requestAnimationFrame(_._draw)),s},immediate(i){const t=_.immediates.push(i);return _.nextDraw===null&&(_.nextDraw=v.window.requestAnimationFrame(_._draw)),t},cancelFrame(i){i!=null&&_.frames.remove(i)},clearTimeout(i){i!=null&&_.timeouts.remove(i)},cancelImmediate(i){i!=null&&_.immediates.remove(i)},_draw(i){let t=null;const e=_.timeouts.last();for(;(t=_.timeouts.shift())&&(i>=t.time?t.run():_.timeouts.push(t),t!==e););let s=null;const n=_.frames.last();for(;s!==n&&(s=_.frames.shift());)s.run(i);let r=null;for(;r=_.immediates.shift();)r();_.nextDraw=_.timeouts.first()||_.frames.first()?v.window.requestAnimationFrame(_._draw):null}},Ts=function(i){const t=i.start,e=i.runner.duration(),s=t+e;return{start:t,duration:e,end:s,runner:i.runner}},Os=function(){const i=v.window;return(i.performance||i.Date).now()};class Le extends mt{constructor(t=Os){super(),this._timeSource=t,this._startTime=0,this._speed=1,this._persist=0,this._nextFrame=null,this._paused=!0,this._runners=[],this._runnerIds=[],this._lastRunnerId=-1,this._time=0,this._lastSourceTime=0,this._lastStepTime=0,this._step=this._stepFn.bind(this,!1),this._stepImmediate=this._stepFn.bind(this,!0)}active(){return!!this._nextFrame}finish(){return this.time(this.getEndTimeOfTimeline()+1),this.pause()}getEndTime(){const t=this.getLastRunnerInfo(),e=t?t.runner.duration():0;return(t?t.start:this._time)+e}getEndTimeOfTimeline(){const t=this._runners.map(e=>e.start+e.runner.duration());return Math.max(0,...t)}getLastRunnerInfo(){return this.getRunnerInfoById(this._lastRunnerId)}getRunnerInfoById(t){return this._runners[this._runnerIds.indexOf(t)]||null}pause(){return this._paused=!0,this._continue()}persist(t){return t==null?this._persist:(this._persist=t,this)}play(){return this._paused=!1,this.updateTime()._continue()}reverse(t){const e=this.speed();if(t==null)return this.speed(-e);const s=Math.abs(e);return this.speed(t?-s:s)}schedule(t,e,s){if(t==null)return this._runners.map(Ts);let n=0;const r=this.getEndTime();if(e=e||0,s==null||s==="last"||s==="after")n=r;else if(s==="absolute"||s==="start")n=e,e=0;else if(s==="now")n=this._time;else if(s==="relative"){const h=this.getRunnerInfoById(t.id);h&&(n=h.start+e,e=0)}else if(s==="with-last"){const h=this.getLastRunnerInfo();n=h?h.start:this._time}else throw new Error('Invalid value for the "when" parameter');t.unschedule(),t.timeline(this);const o=t.persist(),a={persist:o===null?this._persist:o,start:n+e,runner:t};return this._lastRunnerId=t.id,this._runners.push(a),this._runners.sort((h,u)=>h.start-u.start),this._runnerIds=this._runners.map(h=>h.runner.id),this.updateTime()._continue(),this}seek(t){return this.time(this._time+t)}source(t){return t==null?this._timeSource:(this._timeSource=t,this)}speed(t){return t==null?this._speed:(this._speed=t,this)}stop(){return this.time(0),this.pause()}time(t){return t==null?this._time:(this._time=t,this._continue(!0))}unschedule(t){const e=this._runnerIds.indexOf(t.id);return e<0?this:(this._runners.splice(e,1),this._runnerIds.splice(e,1),t.timeline(null),this)}updateTime(){return this.active()||(this._lastSourceTime=this._timeSource()),this}_continue(t=!1){return _.cancelFrame(this._nextFrame),this._nextFrame=null,t?this._stepImmediate():this._paused?this:(this._nextFrame=_.frame(this._step),this)}_stepFn(t=!1){const e=this._timeSource();let s=e-this._lastSourceTime;t&&(s=0);const n=this._speed*s+(this._time-this._lastStepTime);this._lastSourceTime=e,t||(this._time+=n,this._time=this._time<0?0:this._time),this._lastStepTime=this._time,this.fire("time",this._time);for(let o=this._runners.length;o--;){const a=this._runners[o],h=a.runner;this._time-a.start<=0&&h.reset()}let r=!1;for(let o=0,a=this._runners.length;o<a;o++){const h=this._runners[o],u=h.runner;let c=n;const l=this._time-h.start;if(l<=0){r=!0;continue}else l<c&&(c=l);if(!u.active())continue;u.step(c).done?h.persist!==!0&&u.duration()-u.time()+this._time+h.persist<this._time&&(u.unschedule(),--o,--a):r=!0}return r&&!(this._speed<0&&this._time===0)||this._runnerIds.length&&this._speed<0&&this._time>0?this._continue():(this.pause(),this.fire("finished")),this}}g({Element:{timeline:function(i){return i==null?(this._timeline=this._timeline||new Le,this._timeline):(this._timeline=i,this)}}});class P extends mt{constructor(t){super(),this.id=P.id++,t=t??at.duration,t=typeof t=="function"?new Mt(t):t,this._element=null,this._timeline=null,this.done=!1,this._queue=[],this._duration=typeof t=="number"&&t,this._isDeclarative=t instanceof Mt,this._stepper=this._isDeclarative?t:new jt,this._history={},this.enabled=!0,this._time=0,this._lastTime=0,this._reseted=!0,this.transforms=new m,this.transformId=1,this._haveReversed=!1,this._reverse=!1,this._loopsDone=0,this._swing=!1,this._wait=0,this._times=1,this._frameId=null,this._persist=this._isDeclarative?!0:null}static sanitise(t,e,s){let n=1,r=!1,o=0;return t=t||at.duration,e=e||at.delay,s=s||"last",typeof t=="object"&&!(t instanceof se)&&(e=t.delay||e,s=t.when||s,r=t.swing||r,n=t.times||n,o=t.wait||o,t=t.duration||at.duration),{duration:t,delay:e,swing:r,times:n,wait:o,when:s}}active(t){return t==null?this.enabled:(this.enabled=t,this)}addTransform(t,e){return this.transforms.lmultiplyO(t),this}after(t){return this.on("finished",t)}animate(t,e,s){const n=P.sanitise(t,e,s),r=new P(n.duration);return this._timeline&&r.timeline(this._timeline),this._element&&r.element(this._element),r.loop(n).schedule(n.delay,n.when)}clearTransform(){return this.transforms=new m,this}clearTransformsFromQueue(){(!this.done||!this._timeline||!this._timeline._runnerIds.includes(this.id))&&(this._queue=this._queue.filter(t=>!t.isTransform))}delay(t){return this.animate(0,t)}duration(){return this._times*(this._wait+this._duration)-this._wait}during(t){return this.queue(null,t)}ease(t){return this._stepper=new jt(t),this}element(t){return t==null?this._element:(this._element=t,t._prepareRunner(),this)}finish(){return this.step(1/0)}loop(t,e,s){return typeof t=="object"&&(e=t.swing,s=t.wait,t=t.times),this._times=t||1/0,this._swing=e||!1,this._wait=s||0,this._times===!0&&(this._times=1/0),this}loops(t){const e=this._duration+this._wait;if(t==null){const o=Math.floor(this._time/e),h=(this._time-o*e)/this._duration;return Math.min(o+h,this._times)}const s=Math.floor(t),n=t%1,r=e*s+this._duration*n;return this.time(r)}persist(t){return t==null?this._persist:(this._persist=t,this)}position(t){const e=this._time,s=this._duration,n=this._wait,r=this._times,o=this._swing,a=this._reverse;let h;if(t==null){const d=function(b){const S=o*Math.floor(b%(2*(n+s))/(n+s)),M=S&&!a||!S&&a,A=Math.pow(-1,M)*(b%(n+s))/s+M;return Math.max(Math.min(A,1),0)},y=r*(n+s)-n;return h=e<=0?Math.round(d(1e-5)):e<y?d(e):Math.round(d(y-1e-5)),h}const u=Math.floor(this.loops()),c=o&&u%2===0;return h=u+(c&&!a||a&&c?t:1-t),this.loops(h)}progress(t){return t==null?Math.min(1,this._time/this.duration()):this.time(t*this.duration())}queue(t,e,s,n){return this._queue.push({initialiser:t||me,runner:e||me,retarget:s,isTransform:n,initialised:!1,finished:!1}),this.timeline()&&this.timeline()._continue(),this}reset(){return this._reseted?this:(this.time(0),this._reseted=!0,this)}reverse(t){return this._reverse=t??!this._reverse,this}schedule(t,e,s){if(t instanceof Le||(s=e,e=t,t=this.timeline()),!t)throw Error("Runner cannot be scheduled without timeline");return t.schedule(this,e,s),this}step(t){if(!this.enabled)return this;t=t??16,this._time+=t;const e=this.position(),s=this._lastPosition!==e&&this._time>=0;this._lastPosition=e;const n=this.duration(),r=this._lastTime<=0&&this._time>0,o=this._lastTime<n&&this._time>=n;this._lastTime=this._time,r&&this.fire("start",this);const a=this._isDeclarative;this.done=!a&&!o&&this._time>=n,this._reseted=!1;let h=!1;return(s||a)&&(this._initialise(s),this.transforms=new m,h=this._run(a?t:e),this.fire("step",this)),this.done=this.done||h&&a,o&&this.fire("finished",this),this}time(t){if(t==null)return this._time;const e=t-this._time;return this.step(e),this}timeline(t){return typeof t>"u"?this._timeline:(this._timeline=t,this)}unschedule(){const t=this.timeline();return t&&t.unschedule(this),this}_initialise(t){if(!(!t&&!this._isDeclarative))for(let e=0,s=this._queue.length;e<s;++e){const n=this._queue[e],r=this._isDeclarative||!n.initialised&&t;t=!n.finished,r&&t&&(n.initialiser.call(this),n.initialised=!0)}}_rememberMorpher(t,e){if(this._history[t]={morpher:e,caller:this._queue[this._queue.length-1]},this._isDeclarative){const s=this.timeline();s&&s.play()}}_run(t){let e=!0;for(let s=0,n=this._queue.length;s<n;++s){const r=this._queue[s],o=r.runner.call(this,t);r.finished=r.finished||o===!0,e=e&&r.finished}return e}_tryRetarget(t,e,s){if(this._history[t]){if(!this._history[t].caller.initialised){const r=this._queue.indexOf(this._history[t].caller);return this._queue.splice(r,1),!1}this._history[t].caller.retarget?this._history[t].caller.retarget.call(this,e,s):this._history[t].morpher.to(e),this._history[t].caller.finished=!1;const n=this.timeline();return n&&n.play(),!0}return!1}}P.id=0;class St{constructor(t=new m,e=-1,s=!0){this.transforms=t,this.id=e,this.done=s}clearTransformsFromQueue(){}}w([P,St],{mergeWith(i){return new St(i.transforms.lmultiply(this.transforms),i.id)}});const je=(i,t)=>i.lmultiplyO(t),qe=i=>i.transforms;function Cs(){const t=this._transformationRunners.runners.map(qe).reduce(je,new m);this.transform(t),this._transformationRunners.merge(),this._transformationRunners.length()===1&&(this._frameId=null)}class Is{constructor(){this.runners=[],this.ids=[]}add(t){if(this.runners.includes(t))return;const e=t.id+1;return this.runners.push(t),this.ids.push(e),this}clearBefore(t){const e=this.ids.indexOf(t+1)||1;return this.ids.splice(0,e,0),this.runners.splice(0,e,new St).forEach(s=>s.clearTransformsFromQueue()),this}edit(t,e){const s=this.ids.indexOf(t+1);return this.ids.splice(s,1,t+1),this.runners.splice(s,1,e),this}getByID(t){return this.runners[this.ids.indexOf(t+1)]}length(){return this.ids.length}merge(){let t=null;for(let e=0;e<this.runners.length;++e){const s=this.runners[e];if(t&&s.done&&t.done&&(!s._timeline||!s._timeline._runnerIds.includes(s.id))&&(!t._timeline||!t._timeline._runnerIds.includes(t.id))){this.remove(s.id);const r=s.mergeWith(t);this.edit(t.id,r),t=r,--e}else t=s}return this}remove(t){const e=this.ids.indexOf(t+1);return this.ids.splice(e,1),this.runners.splice(e,1),this}}g({Element:{animate(i,t,e){const s=P.sanitise(i,t,e),n=this.timeline();return new P(s.duration).loop(s).element(this).timeline(n.play()).schedule(s.delay,s.when)},delay(i,t){return this.animate(0,i,t)},_clearTransformRunnersBefore(i){this._transformationRunners.clearBefore(i.id)},_currentTransform(i){return this._transformationRunners.runners.filter(t=>t.id<=i.id).map(qe).reduce(je,new m)},_addRunner(i){this._transformationRunners.add(i),_.cancelImmediate(this._frameId),this._frameId=_.immediate(Cs.bind(this))},_prepareRunner(){this._frameId==null&&(this._transformationRunners=new Is().add(new St(new m(this))))}}});const Ps=(i,t)=>i.filter(e=>!t.includes(e));w(P,{attr(i,t){return this.styleAttr("attr",i,t)},css(i,t){return this.styleAttr("css",i,t)},styleAttr(i,t,e){if(typeof t=="string")return this.styleAttr(i,{[t]:e});let s=t;if(this._tryRetarget(i,s))return this;let n=new G(this._stepper).to(s),r=Object.keys(s);return this.queue(function(){n=n.from(this.element()[i](r))},function(o){return this.element()[i](n.at(o).valueOf()),n.done()},function(o){const a=Object.keys(o),h=Ps(a,r);if(h.length){const c=this.element()[i](h),l=new ft(n.from()).valueOf();Object.assign(l,c),n.from(l)}const u=new ft(n.to()).valueOf();Object.assign(u,o),n.to(u),r=a,s=o}),this._rememberMorpher(i,n),this},zoom(i,t){if(this._tryRetarget("zoom",i,t))return this;let e=new G(this._stepper).to(new p(i));return this.queue(function(){e=e.from(this.element().zoom())},function(s){return this.element().zoom(e.at(s),t),e.done()},function(s,n){t=n,e.to(s)}),this._rememberMorpher("zoom",e),this},transform(i,t,e){if(t=i.relative||t,this._isDeclarative&&!t&&this._tryRetarget("transform",i))return this;const s=m.isMatrixLike(i);e=i.affine!=null?i.affine:e??!s;const n=new G(this._stepper).type(e?gt:m);let r,o,a,h,u;function c(){o=o||this.element(),r=r||Ht(i,o),u=new m(t?void 0:o),o._addRunner(this),t||o._clearTransformRunnersBefore(this)}function l(y){t||this.clearTransform();const{x:b,y:S}=new k(r).transform(o._currentTransform(this));let M=new m({...i,origin:[b,S]}),A=this._isDeclarative&&a?a:u;if(e){M=M.decompose(b,S),A=A.decompose(b,S);const L=M.rotate,Y=A.rotate,X=[L-360,L,L+360],$=X.map(Ve=>Math.abs(Ve-Y)),bt=Math.min(...$),xt=$.indexOf(bt);M.rotate=X[xt]}t&&(s||(M.rotate=i.rotate||0),this._isDeclarative&&h&&(A.rotate=h)),n.from(A),n.to(M);const H=n.at(y);return h=H.rotate,a=new m(H),this.addTransform(a),o._addRunner(this),n.done()}function d(y){(y.origin||"center").toString()!==(i.origin||"center").toString()&&(r=Ht(y,o)),i={...y,origin:r}}return this.queue(c,l,d,!0),this._isDeclarative&&this._rememberMorpher("transform",n),this},x(i,t){return this._queueNumber("x",i)},y(i){return this._queueNumber("y",i)},dx(i=0){return this._queueNumberDelta("x",i)},dy(i=0){return this._queueNumberDelta("y",i)},dmove(i,t){return this.dx(i).dy(t)},_queueNumberDelta(i,t){if(t=new p(t),this._tryRetarget(i,t))return this;const e=new G(this._stepper).to(t);let s=null;return this.queue(function(){s=this.element()[i](),e.from(s),e.to(s+t)},function(n){return this.element()[i](e.at(n)),e.done()},function(n){e.to(s+new p(n))}),this._rememberMorpher(i,e),this},_queueObject(i,t){if(this._tryRetarget(i,t))return this;const e=new G(this._stepper).to(t);return this.queue(function(){e.from(this.element()[i]())},function(s){return this.element()[i](e.at(s)),e.done()}),this._rememberMorpher(i,e),this},_queueNumber(i,t){return this._queueObject(i,new p(t))},cx(i){return this._queueNumber("cx",i)},cy(i){return this._queueNumber("cy",i)},move(i,t){return this.x(i).y(t)},center(i,t){return this.cx(i).cy(t)},size(i,t){let e;return(!i||!t)&&(e=this._element.bbox()),i||(i=e.width/e.height*t),t||(t=e.height/e.width*i),this.width(i).height(t)},width(i){return this._queueNumber("width",i)},height(i){return this._queueNumber("height",i)},plot(i,t,e,s){if(arguments.length===4)return this.plot([i,t,e,s]);if(this._tryRetarget("plot",i))return this;const n=new G(this._stepper).type(this._element.MorphArray).to(i);return this.queue(function(){n.from(this._element.array())},function(r){return this._element.plot(n.at(r)),n.done()}),this._rememberMorpher("plot",n),this},leading(i){return this._queueNumber("leading",i)},viewbox(i,t,e,s){return this._queueObject("viewbox",new T(i,t,e,s))},update(i){return typeof i!="object"?this.update({offset:arguments[0],color:arguments[1],opacity:arguments[2]}):(i.opacity!=null&&this.attr("stop-opacity",i.opacity),i.color!=null&&this.attr("stop-color",i.color),i.offset!=null&&this.attr("offset",i.offset),this)}});w(P,{rx:te,ry:ee,from:Pe,to:De});x(P,"Runner");class re extends I{constructor(t,e=t){super(E("svg",t),e),this.namespace()}defs(){return this.isRoot()?z(this.node.querySelector("defs"))||this.put(new Jt):this.root().defs()}isRoot(){return!this.node.parentNode||!(this.node.parentNode instanceof v.window.SVGElement)&&this.node.parentNode.nodeName!=="#document-fragment"}namespace(){return this.isRoot()?this.attr({xmlns:Ut,version:"1.1"}).attr("xmlns:xlink",dt,_t).attr("xmlns:svgjs",Je,_t):this.root().namespace()}removeNamespace(){return this.attr({xmlns:null,version:null}).attr("xmlns:xlink",null,_t).attr("xmlns:svgjs",null,_t)}root(){return this.isRoot()?this:super.root()}}g({Container:{nested:R(function(){return this.put(new re)})}});x(re,"Svg",!0);let oe=class extends I{constructor(t,e=t){super(E("symbol",t),e)}};g({Container:{symbol:R(function(){return this.put(new oe)})}});x(oe,"Symbol");function Ds(i){return this._build===!1&&this.clear(),this.node.appendChild(v.document.createTextNode(i)),this}function zs(){return this.node.getComputedTextLength()}function Hs(i,t=this.bbox()){return i==null?t.x:this.attr("x",this.attr("x")+i-t.x)}function Ls(i,t=this.bbox()){return i==null?t.y:this.attr("y",this.attr("y")+i-t.y)}function js(i,t,e=this.bbox()){return this.x(i,e).y(t,e)}function qs(i,t=this.bbox()){return i==null?t.cx:this.attr("x",this.attr("x")+i-t.cx)}function Ws(i,t=this.bbox()){return i==null?t.cy:this.attr("y",this.attr("y")+i-t.cy)}function Ys(i,t,e=this.bbox()){return this.cx(i,e).cy(t,e)}function Xs(i){return this.attr("x",i)}function Fs(i){return this.attr("y",i)}function Bs(i,t){return this.ax(i).ay(t)}function Vs(i){return this._build=!!i,this}var We={__proto__:null,plain:Ds,length:zs,x:Hs,y:Ls,move:js,cx:qs,cy:Ws,center:Ys,ax:Xs,ay:Fs,amove:Bs,build:Vs};class j extends D{constructor(t,e=t){super(E("text",t),e),this.dom.leading=new p(1.3),this._rebuild=!0,this._build=!1}leading(t){return t==null?this.dom.leading:(this.dom.leading=new p(t),this.rebuild())}rebuild(t){if(typeof t=="boolean"&&(this._rebuild=t),this._rebuild){const e=this;let s=0;const n=this.dom.leading;this.each(function(r){const o=v.window.getComputedStyle(this.node).getPropertyValue("font-size"),a=n*new p(o);this.dom.newLined&&(this.attr("x",e.attr("x")),this.text()===`
`?s+=a:(this.attr("dy",r?a+s:0),s=0))}),this.fire("rebuild")}return this}setData(t){return this.dom=t,this.dom.leading=new p(t.leading||1.3),this}text(t){if(t===void 0){const e=this.node.childNodes;let s=0;t="";for(let n=0,r=e.length;n<r;++n){if(e[n].nodeName==="textPath"){n===0&&(s=1);continue}n!==s&&e[n].nodeType!==3&&z(e[n]).dom.newLined===!0&&(t+=`
`),t+=e[n].textContent}return t}if(this.clear().build(!0),typeof t=="function")t.call(this,this);else{t=(t+"").split(`
`);for(let e=0,s=t.length;e<s;e++)this.newLine(t[e])}return this.build(!1).rebuild()}}w(j,We);g({Container:{text:R(function(i=""){return this.put(new j).text(i)}),plain:R(function(i=""){return this.put(new j).plain(i)})}});x(j,"Text");class Tt extends D{constructor(t,e=t){super(E("tspan",t),e),this._build=!1}dx(t){return this.attr("dx",t)}dy(t){return this.attr("dy",t)}newLine(){this.dom.newLined=!0;const t=this.parent();if(!(t instanceof j))return this;const e=t.index(this),s=v.window.getComputedStyle(this.node).getPropertyValue("font-size"),n=t.dom.leading*new p(s);return this.dy(e?n:0).attr("x",t.x())}text(t){return t==null?this.node.textContent+(this.dom.newLined?`
`:""):(typeof t=="function"?(this.clear().build(!0),t.call(this,this),this.build(!1)):this.plain(t),this)}}w(Tt,We);g({Tspan:{tspan:R(function(i=""){const t=new Tt;return this._build||this.clear(),this.put(t).text(i)})},Text:{newLine:function(i=""){return this.tspan(i).newLine()}}});x(Tt,"Tspan");class he extends D{constructor(t,e=t){super(E("circle",t),e)}radius(t){return this.attr("r",t)}rx(t){return this.attr("r",t)}ry(t){return this.rx(t)}size(t){return this.radius(new p(t).divide(2))}}w(he,{x:Ee,y:ke,cx:Ae,cy:Te,width:Oe,height:Ce});g({Container:{circle:R(function(i=0){return this.put(new he).size(i).move(0,0)})}});x(he,"Circle");class Ft extends I{constructor(t,e=t){super(E("clipPath",t),e)}remove(){return this.targets().forEach(function(t){t.unclip()}),super.remove()}targets(){return rt("svg [clip-path*="+this.id()+"]")}}g({Container:{clip:R(function(){return this.defs().put(new Ft)})},Element:{clipper(){return this.reference("clip-path")},clipWith(i){const t=i instanceof Ft?i:this.parent().clip().add(i);return this.attr("clip-path","url(#"+t.id()+")")},unclip(){return this.attr("clip-path",null)}}});x(Ft,"ClipPath");class Ye extends q{constructor(t,e=t){super(E("foreignObject",t),e)}}g({Container:{foreignObject:R(function(i,t){return this.put(new Ye).size(i,t)})}});x(Ye,"ForeignObject");function $s(i,t){return this.children().forEach((e,s)=>{let n;try{n=e.bbox()}catch{return}const r=new m(e),o=r.translate(i,t).transform(r.inverse()),a=new k(n.x,n.y).transform(o);e.move(a.x,a.y)}),this}function Us(i){return this.dmove(i,0)}function Gs(i){return this.dmove(0,i)}function Ks(i,t=this.bbox()){return i==null?t.height:this.size(t.width,i,t)}function Zs(i=0,t=0,e=this.bbox()){const s=i-e.x,n=t-e.y;return this.dmove(s,n)}function Qs(i,t,e=this.bbox()){const s=nt(this,i,t,e),n=s.width/e.width,r=s.height/e.height;return this.children().forEach((o,a)=>{const h=new k(e).transform(new m(o).inverse());o.scale(n,r,h.x,h.y)}),this}function Js(i,t=this.bbox()){return i==null?t.width:this.size(i,t.height,t)}function tn(i,t=this.bbox()){return i==null?t.x:this.move(i,t.y,t)}function en(i,t=this.bbox()){return i==null?t.y:this.move(t.x,i,t)}var Xe={__proto__:null,dmove:$s,dx:Us,dy:Gs,height:Ks,move:Zs,size:Qs,width:Js,x:tn,y:en};class ae extends I{constructor(t,e=t){super(E("g",t),e)}}w(ae,Xe);g({Container:{group:R(function(){return this.put(new ae)})}});x(ae,"G");class Rt extends I{constructor(t,e=t){super(E("a",t),e)}target(t){return this.attr("target",t)}to(t){return this.attr("href",t,dt)}}w(Rt,Xe);g({Container:{link:R(function(i){return this.put(new Rt).to(i)})},Element:{unlink(){const i=this.linker();if(!i)return this;const t=i.parent();if(!t)return this.remove();const e=t.index(i);return t.add(this,e),i.remove(),this},linkTo(i){let t=this.linker();return t||(t=new Rt,this.wrap(t)),typeof i=="function"?i.call(t,t):t.to(i),this},linker(){const i=this.parent();return i&&i.node.nodeName.toLowerCase()==="a"?i:null}}});x(Rt,"A");class Bt extends I{constructor(t,e=t){super(E("mask",t),e)}remove(){return this.targets().forEach(function(t){t.unmask()}),super.remove()}targets(){return rt("svg [mask*="+this.id()+"]")}}g({Container:{mask:R(function(){return this.defs().put(new Bt)})},Element:{masker(){return this.reference("mask")},maskWith(i){const t=i instanceof Bt?i:this.parent().mask().add(i);return this.attr("mask","url(#"+t.id()+")")},unmask(){return this.attr("mask",null)}}});x(Bt,"Mask");class Fe extends q{constructor(t,e=t){super(E("stop",t),e)}update(t){return(typeof t=="number"||t instanceof p)&&(t={offset:arguments[0],color:arguments[1],opacity:arguments[2]}),t.opacity!=null&&this.attr("stop-opacity",t.opacity),t.color!=null&&this.attr("stop-color",t.color),t.offset!=null&&this.attr("offset",new p(t.offset)),this}}g({Gradient:{stop:function(i,t,e){return this.put(new Fe).update(i,t,e)}}});x(Fe,"Stop");function sn(i,t){if(!i)return"";if(!t)return i;let e=i+"{";for(const s in t)e+=Ze(s)+":"+t[s]+";";return e+="}",e}class Vt extends q{constructor(t,e=t){super(E("style",t),e)}addText(t=""){return this.node.textContent+=t,this}font(t,e,s={}){return this.rule("@font-face",{fontFamily:t,src:e,...s})}rule(t,e){return this.addText(sn(t,e))}}g("Dom",{style(i,t){return this.put(new Vt).rule(i,t)},fontface(i,t,e){return this.put(new Vt).font(i,t,e)}});x(Vt,"Style");class ue extends j{constructor(t,e=t){super(E("textPath",t),e)}array(){const t=this.track();return t?t.array():null}plot(t){const e=this.track();let s=null;return e&&(s=e.plot(t)),t==null?s:this}track(){return this.reference("href")}}g({Container:{textPath:R(function(i,t){return i instanceof j||(i=this.text(i)),i.path(t)})},Text:{path:R(function(i,t=!0){const e=new ue;i instanceof ot||(i=this.defs().path(i)),e.attr("href","#"+i,dt);let s;if(t)for(;s=this.node.firstChild;)e.node.appendChild(s);return this.put(e)}),textPath(){return this.findOne("textPath")}},Path:{text:R(function(i){return i instanceof j||(i=new j().addTo(this.parent()).text(i)),i.path(this)}),targets(){return rt("svg textPath").filter(i=>(i.attr("href")||"").includes(this.id()))}}});ue.prototype.MorphArray=Q;x(ue,"TextPath");class Be extends D{constructor(t,e=t){super(E("use",t),e)}use(t,e){return this.attr("href",(e||"")+"#"+t,dt)}}g({Container:{use:R(function(i,t){return this.put(new Be).use(i,t)})}});x(Be,"Use");const nn=O;w([re,oe,kt,ct,Nt],C("viewbox"));w([lt,wt,yt,ot],C("marker"));w(j,C("Text"));w(ot,C("Path"));w(Jt,C("Defs"));w([j,Tt],C("Tspan"));w([At,Et,pt,P],C("radius"));w(mt,C("EventTarget"));w(B,C("Dom"));w(q,C("Element"));w(D,C("Shape"));w([I,Ie],C("Container"));w(pt,C("Gradient"));w(P,C("Runner"));Z.extend(Ge());Ns([p,N,T,m,st,V,Q,k]);Ms();class rn{constructor(t,e,s){f(this,"svgRoot");f(this,"noteModStartReference");f(this,"notes");f(this,"spatialNoteTracker");f(this,"selectedElements");f(this,"selectedNoteIds");f(this,"selectRect");f(this,"cursorElement");f(this,"cursorPosition");f(this,"lastCursorPosition",0);f(this,"cursorWidth");f(this,"playCursorElement");f(this,"backgroundElements",new Set);f(this,"quarterNoteWidth");f(this,"noteHeight");f(this,"handleRad");f(this,"whiteNotes");f(this,"noteSubDivision");f(this,"timeSignature");f(this,"numMeasures");f(this,"sectionColoringDivision");f(this,"NUM_MIDI_NOTES");f(this,"xSnap");f(this,"ySnap");f(this,"backgroundColor1");f(this,"backgroundColor2");f(this,"noteColor");f(this,"selectedNoteColor");f(this,"thickLineWidth");f(this,"thinLineWidth");f(this,"viewportHeight");f(this,"viewportWidth");f(this,"maxZoom");f(this,"noteCount");f(this,"refPt");f(this,"shiftKeyDown");f(this,"historyList");f(this,"historyListIndex");f(this,"pianoRollHeight",0);f(this,"pianoRollWidth",0);f(this,"pitchStrings");f(this,"textDev");f(this,"mouseScrollActive");f(this,"mouseZoomActive");f(this,"mouseMoveRootNeedsReset");f(this,"mouseMoveRoot");f(this,"nonSelectedModifiedNotes");f(this,"count");f(this,"draggingActive");f(this,"quantDragActivated");f(this,"dragTarget");f(this,"resizingActive");f(this,"quantResizingActivated");f(this,"resizeTarget");f(this,"rawSVGElementToWrapper");f(this,"copiedNoteBuffer");f(this,"containerElement");f(this,"containerElementId");f(this,"temporaryMouseMoveHandler");f(this,"mousePosition");f(this,"playHandler");f(this,"noteOnOffHandler");f(this,"wIsDown");f(this,"debugCircle0");f(this,"debugCircle1");this.svgRoot,this.noteModStartReference={},this.notes={},this.spatialNoteTracker={},this.selectedElements=new Set,this.selectedNoteIds=[],this.selectRect,this.cursorElement,this.cursorPosition=.25,this.cursorWidth=2.1,this.playCursorElement,this.backgroundElements,this.quarterNoteWidth=120,this.noteHeight=20,this.handleRad=5,this.whiteNotes=[0,2,4,5,7,9,11],this.noteSubDivision=16,this.timeSignature=4/4,this.numMeasures=100,this.sectionColoringDivision=4,this.NUM_MIDI_NOTES=128,this.xSnap=1,this.ySnap=this.noteHeight,this.backgroundColor1="#ddd",this.backgroundColor2="#bbb",this.noteColor="#f23",this.selectedNoteColor="#2ee",this.thickLineWidth=1.8,this.thinLineWidth=1,this.viewportHeight=360,this.viewportWidth=640,this.maxZoom,this.noteCount=0,this.refPt,this.shiftKeyDown=!1,this.historyList=[[]],this.historyListIndex=0,this.pianoRollHeight,this.pianoRollWidth,this.pitchStrings=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],this.textDev=4,this.mouseScrollActive=!1,this.mouseZoomActive=!1,this.mouseMoveRootNeedsReset=!0,this.mouseMoveRoot={mouseX:0,mouseY:0,svgX:0,svgY:0,vbX:0,vbY:0,vbWidth:0,vbHeight:0,zoom:0},this.nonSelectedModifiedNotes=new Set,this.count=0,this.draggingActive=!1,this.quantDragActivated=!1,this.resizingActive=!1,this.quantResizingActivated=!1,this.rawSVGElementToWrapper={},this.copiedNoteBuffer=[],this.containerElement=document.getElementById(t),this.containerElement.tabIndex=0,this.containerElementId=t,this.mousePosition={x:0,y:0},this.playHandler=e,this.noteOnOffHandler=s,this.drawBackgroundAndCursor(),this.attachHandlersOnBackground(this.backgroundElements,this.svgRoot),this.svgRoot.viewbox(0,55*this.noteHeight,this.viewportWidth*1.5,this.viewportHeight*1.5),this.debugCircle0=this.svgRoot.circle(10).move(0,0).fill("#f00"),this.debugCircle1=this.svgRoot.circle(10).move(0,0).fill("#0f0"),this.containerElement.addEventListener("keydown",n=>this.keydownHandler(n)),this.containerElement.addEventListener("keyup",n=>this.keyupHandler(n)),this.containerElement.addEventListener("mousemove",n=>{this.mousePosition=this.svgMouseCoord(n)})}drawBackgroundAndCursor(){this.pianoRollHeight=this.noteHeight*this.NUM_MIDI_NOTES;const t=this.timeSignature*4;this.pianoRollWidth=this.quarterNoteWidth*t*this.numMeasures;const e=this.numMeasures*t*(this.noteSubDivision/4),s=this.pianoRollWidth/e;this.xSnap=s;const n=this.quarterNoteWidth*t;this.svgRoot=nn().addTo("#"+this.containerElementId).attr("id","pianoRollSVG").size(this.viewportWidth,this.viewportHeight),this.refPt=this.svgRoot.node.createSVGPoint(),this.maxZoom=this.viewportHeight/this.pianoRollHeight,this.backgroundElements=new Set;for(let r=0;r<this.numMeasures;r++){const o=r%2==0?this.backgroundColor1:this.backgroundColor2,a=this.svgRoot.rect(n,this.pianoRollHeight).move(r*n,0).fill(o);this.backgroundElements.add(a)}for(let r=1;r<e;r++){const o=r*s,a=o%this.quarterNoteWidth==0?this.thickLineWidth:this.thinLineWidth,h=this.svgRoot.line(o,0,o,this.pianoRollHeight).stroke({width:a,color:"#000"});this.backgroundElements.add(h)}for(let r=1;r<this.NUM_MIDI_NOTES;r++){const o=this.svgRoot.line(0,r*this.noteHeight,this.pianoRollWidth,r*this.noteHeight).stroke({width:this.thinLineWidth,color:"#000"});this.backgroundElements.add(o)}this.cursorElement=this.svgRoot.rect(this.cursorWidth,this.pianoRollHeight).move(this.cursorPosition*this.quarterNoteWidth,0).fill(this.noteColor),this.playCursorElement=this.svgRoot.rect(this.cursorWidth,this.pianoRollHeight).move(this.cursorPosition*this.quarterNoteWidth,0).fill("#2d2").opacity(0),this.cursorElement.animate(1500).attr({fill:"#fff"}).loop(1/0,!0)}addNote(t,e,s,n=!1){const r=e*this.quarterNoteWidth,o=(127-t)*this.noteHeight,a=s*this.quarterNoteWidth,h=this.svgRoot.rect(a,this.noteHeight).move(r,o).fill(this.noteColor);h.id(this.noteCount.toString()),this.rawSVGElementToWrapper[h.id()]=h;const u=this.svgRoot.text(this.svgYToPitchString(h.y().valueOf())).font({size:14}).move(r+this.textDev,(127-t)*this.noteHeight),c=this.svgRoot.circle(this.handleRad).move(r-this.handleRad/2,o+(this.noteHeight-this.handleRad)/2).fill("#000"),l=this.svgRoot.circle(this.handleRad).move(r+a-this.handleRad/2,o+(this.noteHeight-this.handleRad)/2).fill("#000"),d={elem:h,info:{pitch:t,position:e,duration:s,velocity:.5},label:u,handles:{start:c,end:l}};return this.notes[this.noteCount]=d,this.attachHandlersOnNote(d,this.svgRoot),this.noteCount++,n||this.snapshotNoteState(),this.playHandler(t),h.id()}deleteElement(t){t.remove();const e=this.notes[t.id()];e.label.remove(),e.handles.start.remove(),e.handles.end.remove()}deleteElements(t){t.forEach(e=>{this.deleteElement(e),delete this.notes[e.id()]}),this.snapshotNoteState()}getNoteData(){return Object.values(this.notes).map(t=>({...t.info}))}setNoteData(t){this.deleteElements(new Set(Object.values(this.notes).map(e=>e.elem))),this.notes={},t.forEach(e=>{this.addNote(e.pitch,e.position,e.duration,!0)}),this.snapshotNoteState()}setViewportToShowAllNotes(){const t=Object.values(this.notes).map(d=>d.info),e=Math.min(...t.map(d=>d.position)),n=Math.max(...t.map(d=>d.position+d.duration))-e,r=Math.min(...t.map(d=>d.pitch)),o=Math.max(...t.map(d=>d.pitch+1)),a=o-r,h=e*this.quarterNoteWidth,u=(127-o)*this.noteHeight,c=n*this.quarterNoteWidth,l=a*this.noteHeight;this.svgRoot.viewbox(h,u,c,l)}updateNoteInfo(t,e){if(t.elem.visible()){const s=this.svgYtoPitch(t.elem.y().valueOf()),n=this.svgXtoPosition(t.elem.x().valueOf()),r=t.elem.width().valueOf()/this.quarterNoteWidth;t.info={pitch:s,position:n,duration:r,velocity:.5}}else this.deleteElement(t.elem),delete this.notes[t.elem.id()];e||this.snapshotNoteState()}updateNoteInfoMultiple(t){t.forEach(e=>this.updateNoteInfo(e,!0)),this.snapshotNoteState()}updateNoteElement(t,e,s,n){t.elem.show(),t.label.show(),t.handles.start.show(),t.handles.end.show();const r=(127-s)*this.noteHeight,o=e*this.quarterNoteWidth,a=n*this.quarterNoteWidth;this.updateNoteElemScreenCoords(t,o,r,a)}updateNoteElemScreenCoords(t,e,s,n,r=!0,o=!0){e=e??t.elem.x().valueOf(),s=s??t.elem.y().valueOf(),n=n??t.elem.width().valueOf(),t.elem.x(e),t.label.x(e+this.textDev),t.handles.start.x(e-this.handleRad/2),t.elem.y(s),t.label.y(s),t.label.text(this.svgYToPitchString(s)),t.handles.start.y(s+(this.noteHeight-this.handleRad)/2),t.handles.end.y(s+(this.noteHeight-this.handleRad)/2),t.elem.width(n),t.handles.end.x(e+n-this.handleRad/2),r&&this.updateNoteInfo(t,o)}svgMouseCoord(t){return this.refPt.x=t.clientX,this.refPt.y=t.clientY,this.refPt.matrixTransform(this.svgRoot.node.getScreenCTM().inverse())}svgYtoPitch(t){return 127-t/this.noteHeight}svgXtoPosition(t){return t/this.quarterNoteWidth}svgXYtoPitchPos(t,e){return{pitch:127-e/this.noteHeight,position:t/this.quarterNoteWidth}}svgXYtoPitchPosQuant(t,e){const s=this.noteSubDivision/4,n=t/this.quarterNoteWidth;return{pitch:127-Math.floor(e/this.noteHeight),position:Math.floor(n*s)/s}}getMouseDelta(t,e){return{x:t.clientX-e.mouseX,y:t.clientY-e.mouseY}}resetMouseMoveRoot(t){const e=this.svgRoot.viewbox(),s=this.svgMouseCoord(t);this.mouseMoveRoot={mouseX:t.clientX,mouseY:t.clientY,svgX:s.x,svgY:s.y,vbX:e.x,vbY:e.y,vbWidth:e.width,vbHeight:e.height,zoom:this.svgRoot.zoom()},this.mouseMoveRootNeedsReset=!1}mouseScrollHandler(t){if(this.mouseMoveRootNeedsReset&&this.resetMouseMoveRoot(t),this.mouseScrollActive){const e=this.getMouseDelta(t,this.mouseMoveRoot),s=(o,a,h)=>Math.min(h,Math.max(a,o)),n=1/this.mouseMoveRoot.zoom,r={x:s(this.mouseMoveRoot.vbX-e.x*n,0,this.pianoRollWidth-this.mouseMoveRoot.vbWidth),y:s(this.mouseMoveRoot.vbY-e.y*n,0,this.pianoRollHeight-this.mouseMoveRoot.vbHeight)};this.svgRoot.viewbox(r.x,r.y,this.mouseMoveRoot.vbWidth,this.mouseMoveRoot.vbHeight)}}mouseZoomHandler(t){if(this.mouseMoveRootNeedsReset&&this.resetMouseMoveRoot(t),this.mouseZoomActive){const e=this.getMouseDelta(t,this.mouseMoveRoot),s=(l,d,y)=>Math.min(y,Math.max(d,l)),n=4**(e.y/this.mouseMoveRoot.zoom/this.mouseMoveRoot.vbHeight);if(this.mouseMoveRoot.zoom*n<this.maxZoom)return;const o=this.mouseMoveRoot.svgX-this.mouseMoveRoot.vbX,a=this.mouseMoveRoot.svgY-this.mouseMoveRoot.vbY,h=this.mouseMoveRoot.vbWidth/n,u=this.mouseMoveRoot.vbHeight/n,c={x:s(this.mouseMoveRoot.svgX-o/n,0,this.pianoRollWidth-h),y:s(this.mouseMoveRoot.svgY-a/n,0,this.pianoRollHeight-u)};this.svgRoot.viewbox(c.x,c.y,h,u)}}keydownHandler(t){if(t.key=="Shift"&&(this.shiftKeyDown=!0),t.ctrlKey&&!t.altKey&&(this.mouseMoveRootNeedsReset=!0,this.mouseScrollActive=!0,this.temporaryMouseMoveHandler=e=>this.mouseScrollHandler(e),this.containerElement.addEventListener("mousemove",this.temporaryMouseMoveHandler)),t.altKey&&!t.ctrlKey&&(this.mouseMoveRootNeedsReset=!0,this.mouseZoomActive=!0,this.temporaryMouseMoveHandler=e=>this.mouseZoomHandler(e),this.containerElement.addEventListener("mousemove",this.temporaryMouseMoveHandler)),t.key=="Backspace"&&this.deleteElements(this.selectedElements),t.key==="z"&&t.metaKey&&(this.shiftKeyDown?this.executeRedo():this.executeUndo()),t.key==="c"&&t.metaKey&&this.selectedElements.size>0&&this.copyNotes(),t.key==="v"&&t.metaKey&&this.copiedNoteBuffer.length>0&&this.pasteNotes(),t.key==="ArrowUp"&&(this.selectedElements.size>0&&this.shiftNotesPitch(1),t.preventDefault()),t.key==="ArrowDown"&&(this.selectedElements.size>0&&this.shiftNotesPitch(-1),t.preventDefault()),t.key==="ArrowLeft"&&(this.selectedElements.size>0&&this.shiftNotesTime(-.25),t.preventDefault()),t.key==="ArrowRight"&&(this.selectedElements.size>0&&this.shiftNotesTime(.25),t.preventDefault()),["Digit1","Digit2","Digit3","Digit4"].includes(t.code)){const e=this.svgXYtoPitchPosQuant(this.mousePosition.x,this.mousePosition.y),n=2**(parseFloat(t.code[5])-1)*(this.shiftKeyDown?2:1)*.25,r=this.addNote(e.pitch,e.position,n,!0);Object.values(this.notes).filter(h=>h.info.pitch==e.pitch).filter(h=>h.info.position<e.position+n&&e.position<h.info.position+h.info.duration).forEach(h=>{if(console.log("checking",h.elem.id()),r!=h.elem.id())if(e.position<=h.info.position&&h.info.position<e.position+n)console.log("delete intersect",h.elem.id()),this.deleteElement(h.elem),delete this.notes[h.elem.id()];else if(e.position<h.info.position+h.info.duration&&h.info.position+h.info.duration<=e.position+n){console.log("truncate end",h.elem.id());const u=h.info.position-e.position;this.updateNoteElement(h,h.info.position,h.info.pitch,u)}else if(h.info.position<=e.position&&e.position+n<=h.info.position+h.info.duration){console.log("truncate contained",h.elem.id());const u=e.position-h.info.position;this.updateNoteElement(h,h.info.position,h.info.pitch,u)}else e.position<=h.info.position&&h.info.position+h.info.duration<=e.position+n?(console.log("delete contains",h.elem.id()),this.deleteElement(h.elem),delete this.notes[h.elem.id()]):console.log("no change",h.elem.id())}),this.snapshotNoteState()}t.key=="q"&&this.getNotesAtPosition(this.cursorPosition+.01).map(e=>this.playHandler(e.pitch)),t.key=="w"&&(this.wIsDown||(this.wIsDown=!0,this.getNotesAtPosition(this.cursorPosition+.01).map(e=>this.noteOnOffHandler(e.pitch,"on")))),t.stopPropagation()}keyupHandler(t){t.key=="Shift"&&(this.shiftKeyDown=!1),!t.ctrlKey&&this.mouseScrollActive&&(this.mouseScrollActive=!1,this.containerElement.removeEventListener("mousemove",this.temporaryMouseMoveHandler),this.temporaryMouseMoveHandler=void 0),!t.altKey&&this.mouseZoomActive&&(this.mouseZoomActive=!1,this.containerElement.removeEventListener("mousemove",this.temporaryMouseMoveHandler),this.temporaryMouseMoveHandler=void 0),t.key=="w"&&(this.wIsDown=!1,this.getNotesAtPosition(this.cursorPosition+.01).map(e=>this.noteOnOffHandler(e.pitch,"off")))}copyNotes(){this.selectedNoteIds=Array.from(this.selectedElements).map(s=>s.id());const t=this.selectedNoteIds.map(s=>this.notes[s].info),e=Math.min(...t.map(s=>s.position));this.copiedNoteBuffer=t.map(s=>{const n=Object.assign({},s);return n.position-=e,n})}pasteNotes(){this.initializeNoteModificationAction(),this.selectedNoteIds=this.copiedNoteBuffer.map(t=>this.addNote(t.pitch,this.cursorPosition+t.position,t.duration,!0)),this.selectedElements=new Set(this.selectedNoteIds.map(t=>this.notes[t].elem)),this.executeOverlapVisibleChanges(),this.updateNoteStateOnModificationCompletion(),Object.keys(this.notes).forEach(t=>this.deselectNote(this.notes[t].elem))}shiftNotesPitch(t){this.initializeNoteModificationAction(),this.selectedNoteIds.forEach(e=>{const s=this.notes[e];s.info.pitch+=t,this.playHandler(s.info.pitch),this.updateNoteElement(s,s.info.position,s.info.pitch,s.info.duration)}),this.executeOverlapVisibleChanges(),this.updateNoteStateOnModificationCompletion()}shiftNotesTime(t){this.initializeNoteModificationAction(),this.selectedNoteIds.forEach(e=>{const s=this.notes[e];s.info.position+=t,this.updateNoteElement(s,s.info.position,s.info.pitch,s.info.duration)}),this.executeOverlapVisibleChanges(),this.updateNoteStateOnModificationCompletion()}snapshotNoteState(){const t=Object.values(this.notes).map(e=>Object.assign({},e.info));this.historyListIndex==this.historyList.length-1?this.historyList.push(t):(this.historyList=this.historyList.splice(0,this.historyListIndex+1),this.historyList.push(t)),this.historyListIndex++}executeUndo(){this.historyListIndex!=0&&(this.historyListIndex--,this.restoreNoteState(this.historyListIndex))}executeRedo(){this.historyListIndex!=this.historyList.length-1&&(this.historyListIndex++,this.restoreNoteState(this.historyListIndex))}restoreNoteState(t){Object.values(this.notes).forEach(s=>this.deleteElement(s.elem)),this.notes={},this.historyList[t].forEach(s=>{this.addNote(s.pitch,s.position,s.duration,!0)})}midiPitchToPitchString(t){return this.pitchStrings[t%12]+(Math.floor(t/12)-2)}svgYToPitchString(t){const e=this.svgYtoPitch(t);return this.midiPitchToPitchString(e)}refreshNoteModStartReference(t){this.noteModStartReference={},t.forEach(e=>{this.noteModStartReference[e]={x:this.notes[e].elem.x().valueOf(),y:this.notes[e].elem.y().valueOf(),width:this.notes[e].elem.width().valueOf(),height:this.notes[e].elem.height().valueOf()}})}getNotesAtPosition(t){return Object.values(this.notes).filter(s=>s.info.position<=t&&t<=s.info.position+s.info.duration).map(s=>s.info)}checkIfNoteMovedSignificantly(t,e){return Math.abs(t.x().valueOf()-this.noteModStartReference[t.id()].x)>e||Math.abs(t.y().valueOf()-this.noteModStartReference[t.id()].y)>e}checkIfNoteResizedSignificantly(t,e){return Math.abs(t.width().valueOf()-this.noteModStartReference[t.id()].width)>e}initializeNoteModificationAction(t){this.selectedNoteIds=Array.from(this.selectedElements).map(e=>e.id()),this.nonSelectedModifiedNotes.clear(),t&&!this.selectedNoteIds.includes(t.id())&&(this.shiftKeyDown||this.clearNoteSelection(),this.selectNote(t),this.selectedNoteIds=[t.id()]),this.populateSpatialNoteTracker(),this.refreshNoteModStartReference(this.selectedNoteIds)}updateNoteStateOnModificationCompletion(){this.refreshNoteModStartReference(this.selectedNoteIds);const t=this.selectedNoteIds.map(e=>this.notes[e]).concat(Array.from(this.nonSelectedModifiedNotes).map(e=>this.notes[e]));this.updateNoteInfoMultiple(t)}endSelect(){var t;(t=this.selectRect)==null||t.remove(),this.svgRoot.off("mousemove"),this.selectRect=void 0}endDrag(){this.draggingActive=!1,this.quantDragActivated=!1,this.svgRoot.off("mousemove"),this.checkIfNoteMovedSignificantly(this.dragTarget,3)&&(this.updateNoteStateOnModificationCompletion(),this.dragTarget=void 0)}endResize(){this.resizingActive=!1,this.quantResizingActivated=!1,this.svgRoot.off("mousemove"),this.checkIfNoteResizedSignificantly(this.resizeTarget,3)&&(console.log("resize done"),this.updateNoteStateOnModificationCompletion(),this.resizeTarget=void 0)}startDragSelection(t){this.clearNoteSelection(),this.selectRect=this.svgRoot.rect().fill("#008").attr("opacity",.25).move(t.x,t.y),this.svgRoot.on("mousemove",e=>{var o,a;const s=this.svgMouseCoord(e),n={x:Math.min(t.x,s.x),y:Math.min(t.y,s.y)},r={x:Math.max(t.x,s.x),y:Math.max(t.y,s.y)};(o=this.selectRect)==null||o.move(n.x,n.y),(a=this.selectRect)==null||a.size(r.x-n.x,r.y-n.y),Object.keys(this.notes).forEach(h=>{const u=this.notes[h].elem;this.selectRectIntersection(u)?this.selectNote(u):this.deselectNote(u)})})}attachHandlersOnBackground(t,e){window.addEventListener("mouseup",()=>{var s;this.selectRect&&this.endSelect(),(s=this.selectRect)==null||s.remove(),this.selectRect=void 0,this.draggingActive&&this.endDrag(),this.resizingActive&&this.endResize()}),t.forEach(s=>{s.on("mousedown",n=>{const r=(h,u)=>Math.round(h/u)*u,o=this.svgMouseCoord(n),a=r(o.x,this.quarterNoteWidth/4);this.cursorElement.x(a-this.cursorWidth/2),this.cursorPosition=a/this.quarterNoteWidth,this.startDragSelection(o)}),s.on("dblclick",n=>{const r=this.svgMouseCoord(n),o=this.svgXYtoPitchPosQuant(r.x,r.y);this.addNote(o.pitch,o.position,4/this.noteSubDivision,!1)})})}setCursorPos(t){this.cursorPosition=t,this.cursorElement.x(t*this.quarterNoteWidth)}populateSpatialNoteTracker(){this.spatialNoteTracker={},Object.values(this.notes).forEach(t=>{this.spatialNoteTracker[t.info.pitch]?this.spatialNoteTracker[t.info.pitch].push(t):(this.spatialNoteTracker[t.info.pitch]=[],this.spatialNoteTracker[t.info.pitch].push(t))}),Object.values(this.spatialNoteTracker).forEach(t=>t.sort((e,s)=>e.info.position-s.info.position))}executeOverlapVisibleChanges(){const t=new Set;this.selectedElements.forEach(s=>{const n=this.notes[s.id()],r=this.spatialNoteTracker[n.info.pitch];r&&r.forEach(o=>{if(s.id()!=o.elem.id())if(this.selectedElements.has(o.elem))o.elem.x()<n.elem.x(),o.elem.x()>n.elem.x();else if(o.info.position<n.info.position&&n.info.position<o.info.position+o.info.duration){this.count++<10,t.add(o.elem.id()),o.elem.show(),o.label.show(),o.handles.start.show(),o.handles.end.show();const a=(n.info.position-o.info.position)*this.quarterNoteWidth;this.updateNoteElemScreenCoords(o,void 0,void 0,a,!1)}else n.info.position<=o.info.position&&o.info.position<n.info.position+n.info.duration&&(t.add(o.elem.id()),o.elem.hide(),o.label.hide(),o.handles.start.hide(),o.handles.end.hide())})}),this.setDifference(this.nonSelectedModifiedNotes,t).forEach(s=>this.updateNoteElement(this.notes[s],this.notes[s].info.position,this.notes[s].info.pitch,this.notes[s].info.duration)),this.nonSelectedModifiedNotes=t}setDifference(t,e){const s=new Set(t);for(const n of e)s.delete(n);return s}isDragOutOfBounds(){}isResizeOutOfBounds(){}attachHandlersOnNote(t,e){const s=t.elem;s.on("point",n=>{console.log("select",n)}),s.on("mousedown",n=>{!this.mouseScrollActive&&!this.mouseZoomActive&&(this.resetMouseMoveRoot(n),this.dragTarget=this.rawSVGElementToWrapper[n.target.id],console.log("drag target",this.rawSVGElementToWrapper,n.target.id),this.initializeNoteModificationAction(this.dragTarget),this.draggingActive=!0,e.on("mousemove",r=>{const o=this.svgMouseCoord(r);let a;const h=o.x-this.mouseMoveRoot.svgX,u=this.quarterNoteWidth*(4/this.noteSubDivision),c=(y,b)=>Math.floor(y/b)*b,l=(y,b)=>Math.round(y/b)*b;Math.abs(o.x-this.mouseMoveRoot.svgX)<u*.9&&!this.quantDragActivated?a=h:(a=l(h,u),this.quantDragActivated=!0);const d=c(o.y,this.noteHeight)-c(this.mouseMoveRoot.svgY,this.noteHeight);this.selectedNoteIds.forEach(y=>{const b=this.noteModStartReference[y],S=b.x+a,M=b.y+d;this.updateNoteElemScreenCoords(this.notes[y],S,M)}),this.executeOverlapVisibleChanges()}))}),t.handles.start.on("mousedown",n=>{s.fire("resizestart",{startMouseEvt:n,isEndChange:!1})}),t.handles.end.on("mousedown",n=>{s.fire("resizestart",{startMouseEvt:n,isEndChange:!0})}),s.on("resizestart",n=>{this.resizeTarget=this.rawSVGElementToWrapper[n.target.id],this.initializeNoteModificationAction(this.resizeTarget),console.log("restireStartEvent",n);const r=n.detail.isEndChange,o=n.detail.startMouseEvt,a=this.svgMouseCoord(o);this.resizingActive=!0,e.on("mousemove",h=>{const c=this.svgMouseCoord(h).x-a.x;this.selectedNoteIds.forEach(l=>{const d=this.noteModStartReference[l];if(r){const y=d.width+c;this.updateNoteElemScreenCoords(this.notes[l],void 0,void 0,y)}else{const y=d.x+c,b=d.width-c;this.updateNoteElemScreenCoords(this.notes[l],y,void 0,b)}}),this.executeOverlapVisibleChanges()})}),s.on("dblclick",n=>{this.deleteElements(new Set([this.rawSVGElementToWrapper[n.target.id]]))})}selectNote(t){this.selectedElements.has(t)||(this.selectedElements.add(t),t.fill(this.selectedNoteColor),this.playHandler(this.notes[t.id()].info.pitch))}deselectNote(t){this.selectedElements.has(t)&&(this.selectedElements.delete(t),t.fill(this.noteColor))}selectRectIntersection(t){const e={tl:{x:t.x().valueOf(),y:t.y().valueOf()-this.noteHeight/2},br:{x:t.x().valueOf()+t.width().valueOf(),y:t.y().valueOf()+this.noteHeight/2}},s=this.selectRect.node.getBBox(),n={tl:{x:s.x,y:s.y},br:{x:s.x+s.width,y:s.y+s.height}};return this.boxIntersect(e,n)}boxIntersect(t,e){let s=!0;return(t.br.x<e.tl.x||t.tl.x>e.br.x)&&(s=!1),(t.tl.y>e.br.y||t.br.y<e.tl.y)&&(s=!1),s}clearNoteSelection(){this.selectedElements.forEach(t=>this.deselectNote(t))}}new rn("app",()=>null,()=>null);

</script>
    <style>
:root{font-family:Inter,system-ui,Avenir,Helvetica,Arial,sans-serif;line-height:1.5;font-weight:400;color-scheme:light dark;color:#ffffffde;background-color:#242424;font-synthesis:none;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}a{font-weight:500;color:#646cff;text-decoration:inherit}a:hover{color:#535bf2}body{margin:0;display:flex;place-items:center;min-width:320px;min-height:100vh}h1{font-size:3.2em;line-height:1.1}#app{max-width:1280px;margin:0 auto;padding:2rem;text-align:center}.logo{height:6em;padding:1.5em;will-change:filter;transition:filter .3s}.logo:hover{filter:drop-shadow(0 0 2em #646cffaa)}.logo.vanilla:hover{filter:drop-shadow(0 0 2em #3178c6aa)}.card{padding:2em}.read-the-docs{color:#888}button{border-radius:8px;border:1px solid transparent;padding:.6em 1.2em;font-size:1em;font-weight:500;font-family:inherit;background-color:#1a1a1a;cursor:pointer;transition:border-color .25s}button:hover{border-color:#646cff}button:focus,button:focus-visible{outline:4px auto -webkit-focus-ring-color}@media (prefers-color-scheme: light){:root{color:#213547;background-color:#fff}a:hover{color:#747bff}button{background-color:#f9f9f9}}

</style>
  </head>
  <body>
    <div id="app"></div>
  </body>
</html>
